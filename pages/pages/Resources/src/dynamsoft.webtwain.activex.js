!function(){"use strict";function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e){var r=function(e,r){if("object"!==n(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(t!==undefined){var o=t.call(e,r||"default");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"===n(r)?r:String(r)}function t(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,r(o.key),o)}}function o(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(e,n,t){return(n=r(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var a,s=!1,u=!0,c=globalThis.Dynamsoft,l=c.Lib,d=c.Lib,f=d.each,g=d.error,T=d.isFunction,p=d.isString,h=c.navInfoSync,m=h.bIE&&parseInt(h.IEVersion)<=9,_=h.bIE&&parseInt(h.IEVersion)<=10,I=window,S=new d.Uri(location.href),v=S&&/^(?:about|app|app\-storage|.+\-extension|file|widget)$/.test(S.getScheme()),w=!1,E=function(){try{return new I.XMLHttpRequest}catch(e){}},b=function(){try{var e=s;return f(["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.3.0","Msxml3.XMLHTTP"],(function(n){try{if(!e)return e=new I.ActiveXObject(n),s}catch(r){g("new xhr error: "+r.message)}})),e}catch(n){}},y=!(v||!I.XMLHttpRequest)&&"withCredentials"in(E()||[]),W=I.ActiveXObject?function(e){return m?b():!v&&E()||b()}:E,C=function(e){return w},D=/^(?:GET|HEAD)$/,P=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,A={xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},O=a;_&&(O=d.noop);var F=function(){function n(){e(this,n),i(this,"url",!1),i(this,"onSuccess",!1),i(this,"onError",!1),i(this,"onComplete",!1),i(this,"method","GET"),i(this,"async",!0),i(this,"xhrFields",!1),i(this,"mimeType",!1),i(this,"username",!1),i(this,"password",!1),i(this,"data",!1),i(this,"dataType","text"),i(this,"headers",!1),i(this,"contentType","application/x-www-form-urlencoded; charset=UTF-8"),i(this,"beforeSend",!1),i(this,"afterSend",!1),i(this,"timeout",0),i(this,"cache",!0),i(this,"crossDomain",!1),i(this,"retry",0)}return o(n,[{key:"setRequestHeader",value:function(e,n){this.headers[e]=n}},{key:"getAllResponseHeaders",value:function(){return 2===this.state?this.responseHeadersString:null}},{key:"getNativeXhr",value:function(){return this.nativeXhr}},{key:"getResponseHeader",value:function(e){var n,r;if(e=e.toLowerCase(),2===this.state){if(!(r=this.responseHeaders))for(r=this.responseHeaders={};n=P.exec(this.responseHeadersString);)r[n[1].toLowerCase()]=n[2];n=r[e]}return n===undefined?null:n}},{key:"overrideMimeType",value:function(e){return this.state||(this.mimeType=e),this}},{key:"abort",value:function(e){return this.state=3,this.status=0,this.statusText=null!=e?e:"abort",this.nativeXhr&&this.nativeXhr.abort(),this._callback(),this}},{key:"_ioReady",value:function(e,n){var r=!1,t=this;if(2!==this.state&&3!==this.state){1===this.state&&(this.state=2),this.readyState=4,e>=200&&e<300||304===e?304===e?(n="not modified",r=!0):(n="success",r=!0):e<0&&(e=0);try{e>=200&&this.handleResponseData()}catch(o){g(o,"error"),n=o.message||"parser error"}if((e<200||!r)&&this.retry>0)return this.retry=this.retry-1,void setTimeout((function(){t.sendInternal()}),200);this.status=e,this.statusText=n,this._callback(r)}}},{key:"_callback",value:function(e){var n=this,r=this.timeoutTimer;r&&(clearTimeout(r),this.timeoutTimer=0),f([e?this.onSuccess:this.onError,this.onComplete],(function(e){T(e)&&e.apply(n.context,[n.responseData,n.statusText,n])})),this.responseData=null}},{key:"handleResponseData",value:function(){var e,n=this.dataType,r=this.nativeXhr;if("blob"===n||"arraybuffer"===n)if(m){var t,o,i;if("responseBody"in r)t=r.responseBody,o=I.dsVbsBinGetLength(t),e=new I.VBArray(I.dsVbsBinGetBytes(t,0,o)).toArray();else for(e=[],o=(t=r.responseText).length,i=0;i<o;++i)e.push(255&t.charCodeAt(i));t=null}else e=I.Blob?r.response:"responseBody"in r?r.responseBody:r.responseText;else if("json"==n)e=r.responseType&&"json"==r.responseType.toLowerCase()?r.response:r.responseText?c.Lib.parse(r.responseText):c.Lib.parse(r.response);else if("user-defined"===n)e=r.response!==undefined?r.response:r.responseText;else{this.responseText=e=r.responseText||"";try{var a=r.responseXML;a&&a.documentElement&&(this.responseXML=a)}catch(s){}}this.responseData=e}},{key:"sendInternal",value:function(e){var n,r,t,o,i,a,s,u,c,l,_,I=this;if(r=(n=this._setup(e)).method,p(r)&&(r=r.toUpperCase()),i=n.contentType,t=n.url,o=n.dataType,u=n.mimeType,p(t)&&(this.nativeXhr=a=W(n.crossDomain),a)){try{if(this.state=1,n.username?a.open(r,t,n.async,n.username,n.password):a.open(r,t,n.async),(n.async||h.bIE)&&o&&"user-defined"!=o&&"responseType"in a)try{a.responseType=o}catch(S){}}catch(v){return void(this.state<2?(g(v,"error"),this._ioReady(-1,"open error: "+(d.isNumber(v.number)?"("+v.number+")":"")+(v.message||""))):g(v))}"withCredentials"in(s=n.xhrFields||{})&&(y||delete s.withCredentials),f(s,(function(e,n){try{a[n]=e}catch(S){g(S)}})),u&&a.overrideMimeType&&a.overrideMimeType(u),!1===(c=n.headers||{})["X-Requested-With"]&&delete c["X-Requested-With"],"setRequestHeader"in a&&(i&&a.setRequestHeader("Content-Type",n.contentType),a.setRequestHeader("Accept",o&&A[o]?A[o]+("*"===o?"":", */*; q=0.01"):A["*"]),f(c,(function(e,n){a.setRequestHeader(n,e)}))),n.cache||(a.setRequestHeader("If-Modified-Since","0"),a.setRequestHeader("Cache-Control","no-cache")),_=(l=!D.test(n.method))&&n.data||null,l&&m&&(_=n.data),n.async&&n.timeout>0&&(n.timeout<300&&(n.timeout=300),this.timeoutTimer=setTimeout((function(){I.abort("timeout")}),n.timeout));try{if(this.state=1,T(this.beforeSend))if(!1===this.beforeSend(a,I))return void this.abort("cancel");a.send(_),_=null,n.data=null,T(this.afterSend)&&this.afterSend(I)}catch(S){this.state<2?(g(S,"error"),this._ioReady(-1,"send error: "+(S.message||""))):g(S)}n.async&&4!==a.readyState?a.onreadystatechange=function(){I._xhrCallback()}:I._xhrCallback()}}},{key:"_xhrCallback",value:function(e,n){var r=this.nativeXhr;try{if(4===r.readyState||n)if(C()||(r.onreadystatechange=O),n)4!==r.readyState&&r.abort();else{C()||(this.responseHeadersString=r.getAllResponseHeaders());var t,o=r.status;try{t=r.statusText}catch(i){g("xhr statusText error: "),g(i),t=""}this._ioReady(o,t)}}catch(i){g(i,"error"),r.onreadystatechange=O,n||this._ioReady(-1,i.message||"process error")}}},{key:"_setup",value:function(e){var r,t,o,i,s;if(e){for(t in this.context=e.context,delete e.context,e instanceof n&&(e=e.config),this.config=e,i=e.url,d.startsWith(i,"//")&&(e.url=i="http:"+i),(d.startsWith(i,"http://")||d.startsWith(i,"https://"))&&(s=new d.Uri(i)),r=e.dataType?e.dataType.toLowerCase():"text",e.dataType=r,e.method?e.method=e.method.toUpperCase():e.method="GET",s&&!("crossDomain"in e)&&(e.crossDomain=!s.isSameOriginAs(S)),o=e.headers)o[t]===a&&delete o[t];d.mix(this,e)}return this.state=1,this}},{key:"dispose",value:function(){this.responseHeaders=null,this.responseHeadersString=null,this.responseData=null,this.responseText=null,this.responseXML=null,this.context=null,this.config=null,this.onSuccess=null,this.onError=null,this.onComplete=null,this.xhrFields=null,this.data=null,this.headers=null,this.beforeSend=null,this.afterSend=null}}]),n}();function x(e){if(e&&p(e.url)){var n=new F;return n.sendInternal(e),n}d.log("the url is error.")}var R,N,L=c.Lib,k=c.navInfoSync,M=k.bIE&&parseInt(k.IEVersion)<=9;R=self&&self.fetch?self.fetch:window.fetch;var B=0;function U(e,n){var r,t=!1;return B=n,R?r=function(r,o){var i=!1,a="text",s=!1;if(o&&(o.dataType&&(a=o.dataType),o.fetchRaw&&(s=!0),o.timeout)){var u=o.timeout;u<300&&(u=300);var l=new AbortController;o.signal=l.signal,setTimeout((function(){i||l.abort()}),u)}t=!1;var d=R(r,o).then((function(r){if(r.ok){var o,a;if(i=!0,!e)return r;e.IfShowCancelDialogWhenImageTransfer?(G(!0),a=e.on("cancel",(function(){t=!0}))):G(!1);var s=r.headers.get("Content-Length"),u=0;e._onPercent&&B==n&&e._onPercent({loaded:u,total:s});var c=null==r||null===(o=r.body)||void 0===o?void 0:o.getReader(),l=new ReadableStream({start:function(r){c?setTimeout((function o(){return c.read().then((function(i){if(i.done||t)return t?c.cancel():a&&e.off("cancel",a),r.close(),void(a=null);var l=i.value;u+=l.length,e._onPercent&&B==n&&e._onPercent({loaded:u,total:s});try{return r.enqueue(l),o()}catch(d){L.error(d)}}))}),0):r.close()}}),d=r.headers.get("Content-Type");return d&&""!=d||(d="application/octet-stream"),new Response(l,{headers:{"Content-Type":d}})}if("opaqueredirect"==r.type)throw L.Errors.HTTPRedirected();var f;throw f={},L.Errors.HTTPError(f,r.status,r.statusText),{code:f._errorCode,message:f._errorString,httpCode:r.status}}));return s?d:(d="blob"==a?d.then((function(e){var n=e.headers.get("content-type");return"text/json"==n?e.json():c.navInfoSync.bLinux?e.arrayBuffer().then((function(e){return new Blob([e],{type:n})})):e.blob()})):"json"==a?d.then((function(e){return e.json()})):"arraybuffer"==a?d.then((function(e){return"text/json"==e.headers.get("content-type")?e.json():e.arrayBuffer()})):d.then((function(e){return e.text()}))).then((function(e){var n;if(t)throw n={},L.Errors.UserCanceled(n),{code:n._errorCode,message:n._errorString};return e}))}:(M&&L.addVBS(["Function dsVbsBinGetAt(strBinary,iOffset)\r\n"," dsVbsBinGetAt=AscB(MidB(strBinary,iOffset+1,1))\r\n","End Function\r\n","Function dsVbsBinGetBytes(strBinary,iOffset,iLength)\r\n"," Dim aBytes()\r\n"," ReDim aBytes(iLength-1)\r\n"," For i=0 To iLength-1\r\n","  aBytes(i)=dsVbsBinGetAt(strBinary,iOffset+i)\r\n"," Next\r\n"," dsVbsBinGetBytes=aBytes\r\n","End Function\r\n","Function dsVbsBinGetLength(strBinary)\r\n"," dsVbsBinGetLength=LenB(strBinary)\r\n","End Function"].join("")),r=function(r,t){return new(L.nativePromise||window.Promise)((function(o,i){var a,s=!1;a={url:r,async:!0,onSuccess:function(e,n,r){o(e)},onError:function(e,n,r){var t;t={},L.Errors.HTTPError(t,r.status,n),i({code:t._errorCode,message:t._errorString,httpCode:r.status})},dataType:"text",method:N,data:N,headers:N,contentType:N,mimeType:N},t&&(t.method&&(a.method=t.method),t.body&&(a.data=t.body),t.headers&&(a.headers||(a.headers={}),L.each(t.headers,(function(e,n){"content-type"==n.toLowerCase()&&(s=!0),a.headers[n]=e}))),t.dataType&&(a.dataType=t.dataType),t.contentType&&(a.contentType=t.contentType)),s&&(a.contentType=!1),"blob"==a.dataType&&M&&(a.mimeType="text/plain; charset=x-user-defined"),e&&(e._onPercent&&(a.beforeSend=function(r,t,o){r.upload.addEventListener("progress",(function(r){e._onPercent&&B==n&&e._onPercent(r)}),!1)}),e.IfShowCancelDialogWhenImageTransfer?G(!0):G(!1));var u=x(a);e&&e.IfShowCancelDialogWhenImageTransfer&&e.on("cancel",(function(){u.abort()}))}))}),r}var H=U(null,0);function G(e){var n=L.one(".dynamsoft-btnCancel"),r=n&&n.getEL();r&&(r.style.display=e?"":"none")}function j(e,n,r,t,o,i,a){try{var s=e[i](a),u=s.value}catch(g){return void r(g)}s.done?n(u):Promise.resolve(u).then(t,o)}function V(e){return function(){var n=this,r=arguments;return new Promise((function(t,o){var i=e.apply(n,r);function a(e){j(i,t,o,a,s,"next",e)}function s(e){j(i,t,o,a,s,"throw",e)}a(undefined)}))}}function X(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}var z={exports:{}},K={exports:{}};!function(e){function n(r){return e.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports["default"]=e.exports,n(r)}e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports}(K);var J=K.exports;!function(e){var n=J["default"];function r(){e.exports=r=function(){return t},e.exports.__esModule=!0,e.exports["default"]=e.exports;var t={},o=Object.prototype,i=o.hasOwnProperty,a=Object.defineProperty||function(e,n,r){e[n]=r.value},s="function"==typeof Symbol?Symbol:{},u=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function d(e,n,r){return Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[n]}try{d({},"")}catch(O){d=function(e,n,r){return e[n]=r}}function f(e,n,r,t){var o=n&&n.prototype instanceof p?n:p,i=Object.create(o.prototype),s=new D(t||[]);return a(i,"_invoke",{value:b(e,r,s)}),i}function g(e,n,r){try{return{type:"normal",arg:e.call(n,r)}}catch(O){return{type:"throw",arg:O}}}t.wrap=f;var T={};function p(){}function h(){}function m(){}var _={};d(_,u,(function(){return this}));var I=Object.getPrototypeOf,S=I&&I(I(P([])));S&&S!==o&&i.call(S,u)&&(_=S);var v=m.prototype=p.prototype=Object.create(_);function w(e){["next","throw","return"].forEach((function(n){d(e,n,(function(e){return this._invoke(n,e)}))}))}function E(e,r){function t(o,a,s,u){var c=g(e[o],e,a);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==n(d)&&i.call(d,"__await")?r.resolve(d.__await).then((function(e){t("next",e,s,u)}),(function(e){t("throw",e,s,u)})):r.resolve(d).then((function(e){l.value=e,s(l)}),(function(e){return t("throw",e,s,u)}))}u(c.arg)}var o;a(this,"_invoke",{value:function(e,n){function i(){return new r((function(r,o){t(e,n,r,o)}))}return o=o?o.then(i,i):i()}})}function b(e,n,r){var t="suspendedStart";return function(o,i){if("executing"===t)throw new Error("Generator is already running");if("completed"===t){if("throw"===o)throw i;return A()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=y(a,r);if(s){if(s===T)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===t)throw t="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);t="executing";var u=g(e,n,r);if("normal"===u.type){if(t=r.done?"completed":"suspendedYield",u.arg===T)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(t="completed",r.method="throw",r.arg=u.arg)}}}function y(e,n){var r=n.method,t=e.iterator[r];if(undefined===t)return n.delegate=null,"throw"===r&&e.iterator["return"]&&(n.method="return",n.arg=undefined,y(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),T;var o=g(t,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,T;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=undefined),n.delegate=null,T):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,T)}function W(e){var n={tryLoc:e[0]};1 in e&&(n.catchLoc=e[1]),2 in e&&(n.finallyLoc=e[2],n.afterLoc=e[3]),this.tryEntries.push(n)}function C(e){var n=e.completion||{};n.type="normal",delete n.arg,e.completion=n}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(W,this),this.reset(!0)}function P(e){if(e){var n=e[u];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,t=function n(){for(;++r<e.length;)if(i.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=undefined,n.done=!0,n};return t.next=t}}return{next:A}}function A(){return{value:undefined,done:!0}}return h.prototype=m,a(v,"constructor",{value:m,configurable:!0}),a(m,"constructor",{value:h,configurable:!0}),h.displayName=d(m,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var n="function"==typeof e&&e.constructor;return!!n&&(n===h||"GeneratorFunction"===(n.displayName||n.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,d(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},t.awrap=function(e){return{__await:e}},w(E.prototype),d(E.prototype,c,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new E(f(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},w(v),d(v,l,"Generator"),d(v,u,(function(){return this})),d(v,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var n=Object(e),r=[];for(var t in n)r.push(t);return r.reverse(),function o(){for(;r.length;){var e=r.pop();if(e in n)return o.value=e,o.done=!1,o}return o.done=!0,o}},t.values=P,D.prototype={constructor:D,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method="next",this.arg=undefined,this.tryEntries.forEach(C),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=undefined)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(r,t){return a.type="throw",a.arg=e,n.next=r,t&&(n.method="next",n.arg=undefined),!!t}for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=i.call(o,"catchLoc"),u=i.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,n){for(var r=this.tryEntries.length-1;r>=0;--r){var t=this.tryEntries[r];if(t.tryLoc<=this.prev&&i.call(t,"finallyLoc")&&this.prev<t.finallyLoc){var o=t;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=n&&n<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=n,o?(this.method="next",this.next=o.finallyLoc,T):this.complete(a)},complete:function(e,n){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&n&&(this.next=n),T},finish:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),T}},"catch":function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc===e){var t=r.completion;if("throw"===t.type){var o=t.arg;C(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:P(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=undefined),T}},t}e.exports=r,e.exports.__esModule=!0,e.exports["default"]=e.exports}(z);var Y=(0,z.exports)(),q=Y;try{regeneratorRuntime=Y}catch(Dr){"object"==typeof globalThis?globalThis.regeneratorRuntime=Y:Function("r","regeneratorRuntime = r")(Y)}var Z=X(q);function Q(e){var n=e.toLowerCase().replace(l.product.name.toLowerCase()+" ","");return(n=l.replaceAll(n,"[.]",",")).split(",")}function $(e){if(e===undefined)return-1;if(e.length<4)return-1;var n=e.lastIndexOf(".");if(-1===n)return-1;var r=e.slice(n).toLowerCase();return".bmp"===r||".dib"===r?c.DWT.EnumDWT_ImageType.IT_BMP:".jpg"===r||".jpe"===r||".jpeg"===r||".jfif"===r?c.DWT.EnumDWT_ImageType.IT_JPG:".tif"===r||".tiff"===r?c.DWT.EnumDWT_ImageType.IT_TIF:".png"===r?c.DWT.EnumDWT_ImageType.IT_PNG:".pdf"===r?c.DWT.EnumDWT_ImageType.IT_PDF:".jp2"===r||".j2k"===r||".j2c"===r?c.DWT.EnumDWT_ImageType.IT_J2K:-1}var ee={TWAINSCANNER:16,WIASCANNER:32,TWAINX64SCANNER:64,ICASCANNER:128,SANESCANNER:256,ESCLSCANNER:512,WIFIDIRECTSCANNER:1024,WIATWAINSCANNER:2048},ne=ee.TWAINSCANNER|ee.WIASCANNER|ee.TWAINX64SCANNER|ee.ICASCANNER|ee.SANESCANNER|ee.ESCLSCANNER|ee.WIFIDIRECTSCANNER|ee.WIATWAINSCANNER,re=ee.TWAINSCANNER|ee.WIASCANNER|ee.WIATWAINSCANNER;c.DWT.EnumDWT_DeviceType={TWAINSCANNER:ee.TWAINSCANNER,WIASCANNER:ee.WIASCANNER,TWAINX64SCANNER:ee.TWAINX64SCANNER,ICASCANNER:ee.ICASCANNER,SANESCANNER:ee.SANESCANNER,ESCLSCANNER:ee.ESCLSCANNER,WIFIDIRECTSCANNER:ee.WIFIDIRECTSCANNER,WIATWAINSCANNER:ee.WIATWAINSCANNER};var te=o((function Pr(){e(this,Pr)}));function oe(e){var n=new te;return n.server=e.server,n.normal=!0,e.attrs&&(n.attrs=l.clone(e.attrs)),n}var ie=o((function Ar(){e(this,Ar)}));function ae(e,n){var r,t=e.name,o="",i=e.deviceType;i==ee.TWAINSCANNER?r="":i==ee.TWAINX64SCANNER?r="Twain64-":i==ee.WIASCANNER?r="WIA-":i==ee.WIATWAINSCANNER?(t=l.replaceAll(t,"WIA-",""),r="WIATWAIN-"):r=i==ee.ICASCANNER?"ICA-":i==ee.SANESCANNER?"Sane-":i==ee.ESCLSCANNER?"eSCL-":(ee.WIFIDIRECTSCANNER,""),n&&n.attrs&&n.attrs.ty&&(o=" on ["+n.attrs.ty+"]"),e.displayName=[r,t,o].join("")}function se(e){if(e.ProductName){var n=e.ProductName;e.ProductName=l.base64.decode(n)}if(e.ProductFamily){var r=e.ProductFamily;e.ProductFamily=l.base64.decode(r)}if(e.Manufacturer){var t=e.Manufacturer;e.Manufacturer=l.base64.decode(t)}if(e.Version&&e.Version.Info){var o=e.Version.Info;e.Version.Info=l.base64.decode(o)}}function ue(e){var n=new ie;return e.deviceInfo&&(n.deviceInfo=l.clone(e.deviceInfo)),e.deviceType&&(n.deviceType=l.clone(e.deviceType)),e.displayName&&(n.displayName=l.clone(e.displayName)),e.name&&(n.name=l.clone(e.name)),e.serviceInfo&&(n.serviceInfo=oe(e.serviceInfo)),n}l.removeNonPrintableChar;var ce,le=function(){function n(r,t,o,i){e(this,n);var a=this;a._md5=o,a._length=t,a._content=i}return o(n,[{key:"getLength",value:function(){return this._length}},{key:"getMD5",value:function(){return this._md5}},{key:"getData",value:function(e,n){var r=this,t=n;return l.isNumber(e)&&l.isNumber(n)?e<0||n<=0?"":0==e&&t==r._length?r._content:(e+t>r._length&&(t=r._length-e),r._content.substr(e,t)):""}}]),n}();l.html5.Base64Result=le,function(e){e.LicenseInvalid=-2325,e.LicenseExpired=-2326,e.LicenseParseFailed=-2546,e.LicenseExpiredForDLS=-2808,e.LicenseNoCoreForDLS=-2809,e.LicenseNoCore=-2810,e.LicenseIsFuture=-2396,e.LicenseVersionNotCurrent=-2539}(ce||(ce={})),c.DWT.EnumDWT_LicenseErrorCode=ce;var de=0,fe=-4201,ge=-5001,Te=-5002,pe=-5003,he=-5004,me="The Web Socket connection failed.",_e="The input is not a JSON object or JSON styled string.",Ie="The object has been disposed.",Se="The task is invalid.",ve="The object need to be disposed.",we=function(){function n(){e(this,n)}return o(n,null,[{key:"message",value:function(e){return this._errorMessage[e]}},{key:"init",value:function(){this._errorMessage[de]="Successful.",this._errorMessage[fe]=me,this._errorMessage[ge]=_e,this._errorMessage[Te]=Ie,this._errorMessage[pe]=Se,this._errorMessage[he]=ve}}]),n}();function Ee(e){return"exception"in e&&"description"in e&&0!=e.exception&&""!=e.description}function be(e,n){l.detect.bMaskShow=!0,c.DWT.ScanDirectly||l.isFunction(c.DWT.OnWebTwainPreExecute)&&c.DWT.OnWebTwainPreExecute(e,n)}i(we,"_errorMessage",Object.create(null)),we.init(),l.install={_divDWTNonInstallContainerID:"dwt-NonInstallContainerID",_divDWTemessageContainer:"",_dlgInstall:!1},l.install._strNonInstallDIV=['<div style="text-align:center;" id="',l.install._divDWTNonInstallContainerID,'"></div>'].join("");var ye=c.DWT;ye.CloseDialog=function(){var e=l.install._dlgInstall;if(e){var n=l.all(".dynamsoft-dialog-close");l.each(n,(function(e,n){l.removeEventListener(e,"click",ye.CloseDialog)})),e.open&&e.close(),document.body.removeChild(e),l.install._dlgInstall=!1}},ye.ShowDialog=function(e,n,r,t,o){if(!1!==r){var i,a={width:e,height:n,position:"absolute"};t?(i=['<div class="dynamsoft-dwt-dialog-body">',r,"</div>"].join(""),a.closeButton=!1):i=['<div class="ds-dwt-ui-showdlg">','<div class="dynamsoft-dwt-dialog-body">','<div class="dynamsoft-dwt-dlg-header">',o?"":'<div class="dynamsoft-dialog-close"></div>',"</div>",r,"</div>","</div>"].join(""),o&&(a.closeButton=!1),ye.ShowMessage(i,a)}},ye.ShowMessage=function(e,n){var r,t,o,i,a,s=l.install,u="ds-dwt-ui-dlg",d="ds-dwt-ui-dlg-wrap",f=screen.width,g=!0,T=0,p=!0,h=!0,m=0,_="fixed",I="Error",S=l.product.bActiveXEdition,v=!1,w=null;if(n&&(r=n.width,t=n.height,n.seconds&&(T=n.seconds),n.headerStyle&&(m=n.headerStyle),1==n.backgroundStyle&&(v=!0),!1===n.closeButton&&(p=!1),n.bAutoClose&&(o=n.bAutoClose,p=!0),0==n.bReadyClosed&&(g=!1),n.position&&(_=n.position),n.caption&&(I=n.caption),l.isFunction(n.onClose)&&(w=n.onClose)),r?r>f-10&&(r=f-10):r=f>600?600:f-10,t||(t="100%"),1==m?e=['<div class="dynamsoft-dialog">','<div class="dynamsoft-dwt-dialog-body">','<div class="dynamsoft-dwt-dlg-header">',p?'<div class="dynamsoft-dialog-close"></div>':"","</div>",e,"</div></div>"].join(""):2==m&&(e=['<div class="dynamsoft-dialog">','<div class="dynamsoft-dwt-ltsdlg-header"><span style="color:#FFF;line-height:35px;margin-left:15px">',I,"</span>",p?'<div class="dynamsoft-dialog-close"></div>':"","</div>",'<div class="dynamsoft-dwt-ltsdlg-body" style="padding:25px 50px 20px 50px;">',e,"</div></div>"].join("")),0==l.one("."+u).length){var E=document.createElement("div"),b=document.createElement("div"),y=document.createElement("div");if(E.className=u,b.className=d,b.style.margin="auto",b.style.zIndex="9999",b.style.position="relative",b.style.border="0",o&&((i=document.createElement("div")).className="dynamsoft-dialog-close",b.insertBefore(i,b.firstElementChild),(a=document.createElement("div")).className="dynamsoft-dialog-closeTimer",a.style.width="100%",a.style.height="2px",a.style.marginTop="-2px",a.style.backgroundColor="#fe8e14",b.insertBefore(a,b.firstElementChild)),b.appendChild(y),y.innerHTML=e,E.appendChild(b),document.body.appendChild(E),w){var W=l.one(".dynamsoft-dialog-close",l.one(E));W&&((W=W[0]).onClose=function(){l.removeEventListener(W,"click",W.onClose),W.onClose=null,w()},l.addEventListener(W,"click",W.onClose))}if(v?l.setBackOpacity({opacity:.4,grayHex:0}):l.setBackOpacity({}),s._dlgInstall=E,l.dialog.setup(s._dlgInstall,!1),c.navInfoSync.bIE){var C=document.createElement("iframe");C.frameborder="0",C.marginheight="0",C.marginwidth="0",C.style.border="0",C.style.backgroundColor="transparent",C.style.position="absolute",C.style.left=0,C.style.top=0,C.style.width="100%",C.style.height=document.body.clientHeight+"px",C.style.margin="0 auto",C.style.zIndex="10000",C.src=["javas","cript:",'""'].join("");var D=l.one(".dynamsoft-backdrop");D&&D.length>0&&(D[0].innerHTML="",D[0].appendChild(C))}}else h=!1;var P=l.one("."+d);if(P&&P.getEL()&&(P[0].style.width=r+"px",l.isNumber(t)&&t>0?P[0].style.height=t+"px":P[0].style.height="100%",h||l.each(P[0].childNodes,(function(n){if("DIV"==n.tagName&&"dynamsoft-dialog-close"!=n.className&&"dynamsoft-dialog-closeTimer"!=n.className)return n.innerHTML=e,!1}))),S){var A=l.one(".dynamsoft-dialog");A&&A.getEL()&&(A.getEL().style.border="1px solid #999")}if(s._dlgInstall.open&&s._dlgInstall.close(),s._dlgInstall.showModal({position:_}),s._dlgInstall.bReadyClosed=g,v&&l.setBackOpacity({}),p){var O=l.all(".dynamsoft-dialog-close");l.each(O,(function(e,n){l.addEventListener(e,"click",ye.CloseDialog)})),O.length>0&&o&&T>0&&setTimeout(l._zdgb_xkz_dhk,100)}},ye.OnWebTwainPreExecute||(ye.OnWebTwainPreExecute=function(e,n){var r,t,o=c.DWT.IfConfineMaskWithinTheViewer;if(o&&(e&&(t=e._containerElement),t||c.DWT.Containers&&c.DWT.Containers.length>0&&c.DWT.Containers[0].ContainerId&&(t=c.Lib.get(c.DWT.Containers[0].ContainerId)),t)){r=t.getBoundingClientRect();for(var i=0;i<t.children.length;i++){var a=t.children[i];if(a&&"dvs-root dvs-web-viewer"==a.className){for(a=a.firstElementChild;a;){if(l.isFunction(a.getBoundingClientRect)){r=a.getBoundingClientRect();break}a=a.nextSibling}t=a;break}}}(t===document.body||r==undefined||c.DWT.Containers&&c.DWT.Containers.length>1||c.DWT.Containers&&1==c.DWT.Containers.length&&(0==r.width||0==r.height))&&(o=!1,t=null);var s=null!=n?n:{};o&&(s={confined:o,wrapperEl:t}),l.showMask(s)}),ye.OnWebTwainPostExecute||(ye.OnWebTwainPostExecute=l.hideMask);var We;function Ce(e){var n=0,r=e.message;l.isNumber(e.code)?n=e.code:l.isString(r)&&(n=-1),0!=n&&function(e,n){l.isFunction(c.OnLicenseError)&&c.OnLicenseError(n,e)}(n,r)}function De(e){Ce(function(e){return{code:e._errorCode,message:e._errorString}}(e))}window.DCP_DWT_OnClickCloseInstall=function(e,n){var r=c.Lib;n||c.DWT.CloseDialog();var t=r.get(r.install._divDWTNonInstallContainerID);if(t&&t.parentNode&&t.parentNode.removeChild(t),e&&r.isDOM(e)&&r.show(e),e&&r.isString(e))r.show(e);else{var o=c.DWT.WebTwainIdMap;if(o){var i,a,s=Object.keys(o);for(i=0;i<s.length;i++)o[a=s[i]]._containerElement&&r.show(o[a]._containerElement)}}""!=r.install._divDWTemessageContainer&&r.show(r.install._divDWTemessageContainer)},function(e){e.SMF_NAME=1,e.SMF_TWAINVERSION=2,e.SMF_TWAINPROTOCOL=4,e.SMF_ICAUUID=8,e.SMF_ICAMODULEVERSION=16,e.SMF_ICALOCATIONTYPE=32}(We||(We={})),c.DWT.EnumDWT_SourceMatchField=We;var Pe=c.DWT;Pe.EnumPDF_Page={Page_Default:0,Page_Custom:1,Page_A4:2,Page_A4_Reverse:3,Page_A3:4,Page_A3_Reverse:5,Page_Letter:6,Page_Letter_Reverse:7,Page_Legal:8,Page_Legal_Reverse:9},Pe.EnumDWT_PixelType={TWPT_BW:0,TWPT_GRAY:1,TWPT_RGB:2,TWPT_PALLETE:3,TWPT_CMY:4,TWPT_CMYK:5,TWPT_YUV:6,TWPT_YUVK:7,TWPT_CIEXYZ:8,TWPT_LAB:9,TWPT_SRGB:10,TWPT_SCRGB:11,TWPT_INFRARED:16},Pe.EnumDWT_BorderStyle={TWBS_NONE:0,TWBS_SINGLEFLAT:1,TWBS_SINGLE3D:2},Pe.EnumDWT_MessageType={TWQC_GET:1,TWQC_SET:2,TWQC_GETDEFAULT:4,TWQC_GETCURRENT:8,TWQC_RESET:16},Pe.EnumDWT_CapType={TWON_NONE:0,TWON_ARRAY:3,TWON_ENUMERATION:4,TWON_ONEVALUE:5,TWON_RANGE:6},Pe.EnumDWT_TransferMode={TWSX_NATIVE:0,TWSX_FILE:1,TWSX_MEMORY:2},Pe.EnumDWT_FileFormat={TWFF_TIFF:0,TWFF_PICT:1,TWFF_BMP:2,TWFF_XBM:3,TWFF_JFIF:4,TWFF_FPX:5,TWFF_TIFFMULTI:6,TWFF_PNG:7,TWFF_SPIFF:8,TWFF_EXIF:9,TWFF_PDF:10,TWFF_JP2:11,TWFF_JPN:12,TWFF_JPX:13,TWFF_DEJAVU:14,TWFF_PDFA:15,TWFF_PDFA2:16},Pe.EnumDWT_TIFFCompressionType={TIFF_AUTO:0,TIFF_NONE:1,TIFF_RLE:2,TIFF_FAX3:3,TIFF_T4:3,TIFF_FAX4:4,TIFF_T6:4,TIFF_LZW:5,TIFF_JPEG:7,TIFF_PACKBITS:32773},Pe.EnumDWT_InterpolationMethod={IM_NEARESTNEIGHBOUR:1,IM_BILINEAR:2,IM_BICUBIC:3,IM_BESTQUALITY:5},Pe.EnumDWT_PDFCompressionType={PDF_AUTO:0,PDF_FAX3:1,PDF_FAX4:2,PDF_LZW:3,PDF_RLE:4,PDF_JPEG:5,PDF_JP2000:6,PDF_JBIG2:7},Pe.EnumDWT_ShowMode={SW_ACTIVE:0,SW_MAX:1,SW_MIN:2,SW_CLOSE:3,SW_IFLIVE:4},Pe.EnumDWT_CapValueType={TWTY_INT8:0,TWTY_INT16:1,TWTY_INT32:2,TWTY_UINT8:3,TWTY_UINT16:4,TWTY_int:5,TWTY_BOOL:6,TWTY_FIX32:7,TWTY_FRAME:8,TWTY_STR32:9,TWTY_STR64:10,TWTY_STR128:11,TWTY_STR255:12},Pe.EnumDWT_UnitType={TWUN_INCHES:0,TWUN_CENTIMETERS:1,TWUN_PICAS:2,TWUN_POINTS:3,TWUN_TWIPS:4,TWUN_PIXELS:5,TWUN_MILLIMETERS:6},Pe.EnumDWT_DUPLEX={TWDX_NONE:0,TWDX_1PASSDUPLEX:1,TWDX_2PASSDUPLEX:2},Pe.EnumDWT_CapFeederAlignment={TWFA_NONE:0,TWFA_LEFT:1,TWFA_CENTER:2,TWFA_RIGHT:3},Pe.EnumDWT_CapFeederOrder={TWFO_FIRSTPAGEFIRST:0,TWFO_LASTPAGEFIRST:1},Pe.EnumDWT_CapPrinter={TWPR_IMPRINTERTOPBEFORE:0,TWPR_IMPRINTERTOPAFTER:1,TWPR_IMPRINTERBOTTOMBEFORE:2,TWPR_IMPRINTERBOTTOMAFTER:3,TWPR_ENDORSERTOPBEFORE:4,TWPR_ENDORSERTOPAFTER:5,TWPR_ENDORSERBOTTOMBEFORE:6,TWPR_ENDORSERBOTTOMAFTER:7},Pe.EnumDWT_CapPrinterMode={TWPM_SINGLESTRING:0,TWPM_MULTISTRING:1,TWPM_COMPOUNDSTRING:2},Pe.EnumDWT_CapBitdepthReduction={TWBR_THRESHOLD:0,TWBR_HALFTONE:1,TWBR_CUSTHALFTONE:2,TWBR_DIFFUSION:3},Pe.EnumDWT_CapBitOrder={TWBO_LSBFIRST:0,TWBO_MSBFIRST:1},Pe.EnumDWT_CapFilterType={TWFT_RED:0,TWFT_GREEN:1,TWFT_BLUE:2,TWFT_NONE:3,TWFT_WHITE:4,TWFT_CYAN:5,TWFT_MAGENTA:6,TWFT_YELLOW:7,TWFT_BLACK:8},Pe.EnumDWT_CapFlash={TWFL_NONE:0,TWFL_OFF:1,TWFL_ON:2,TWFL_AUTO:3,TWFL_REDEYE:4},Pe.EnumDWT_CapFlipRotation={TWFR_BOOK:0,TWFR_FANFOLD:1},Pe.EnumDWT_CapImageFilter={TWIF_NONE:0,TWIF_AUTO:1,TWIF_LOWPASS:2,TWIF_BANDPASS:3,TWIF_HIGHPASS:4,TWIF_TEXT:3,TWIF_FINELINE:4},Pe.EnumDWT_CapLightPath={TWLP_REFLECTIVE:0,TWLP_TRANSMISSIVE:1},Pe.EnumDWT_CapLightSource={TWLS_RED:0,TWLS_GREEN:1,TWLS_BLUE:2,TWLS_NONE:3,TWLS_WHITE:4,TWLS_UV:5,TWLS_IR:6},Pe.EnumDWT_MagType={TWMD_MICR:0,TWMD_RAW:1,TWMD_INVALID:2},Pe.EnumDWT_CapNoiseFilter={TWNF_NONE:0,TWNF_AUTO:1,TWNF_LONEPIXEL:2,TWNF_MAJORITYRULE:3},Pe.EnumDWT_CapORientation={TWOR_ROT0:0,TWOR_ROT90:1,TWOR_ROT180:2,TWOR_ROT270:3,TWOR_PORTRAIT:0,TWOR_LANDSCAPE:3,TWOR_AUTO:4,TWOR_AUTOTEXT:5,TWOR_AUTOPICTURE:6},Pe.EnumDWT_CapOverscan={TWOV_NONE:0,TWOV_AUTO:1,TWOV_TOPBOTTOM:2,TWOV_LEFTRIGHT:3,TWOV_ALL:4},Pe.EnumDWT_CapPixelFlavor={TWPF_CHOCOLATE:0,TWPF_VANILLA:1},Pe.EnumDWT_CapPlanarChunky={TWPC_CHUNKY:0,TWPC_PLANAR:1},Pe.EnumDWT_DataSourceStatus={TWDSS_CLOSED:0,TWDSS_OPENED:1,TWDSS_ENABLED:2,TWDSS_ACQUIRING:3};var Ae=0,Oe=1,Fe=2;Pe.EnumDWT_FitWindowType={enumFitWindow:Ae,enumFitWindowHeight:Oe,enumFitWindowWidth:Fe};var xe={enumUnknown:-1,enumWindow:0,enumMac:1,enumLinux:2,enumEmbed:3,enumChromeOS:4,enumHarmonyOS:5,enumAndroid:6,enumiOS:7};Pe.EnumDWT_PlatformType={enumUnknown:xe.enumUnknown,enumWindow:xe.enumWindow,enumMac:xe.enumMac,enumLinux:xe.enumLinux,enumEmbed:xe.enumEmbed,enumChromeOS:xe.enumChromeOS,enumHarmonyOS:xe.enumHarmonyOS,enumAndroid:xe.enumAndroid,enumiOS:xe.enumiOS};var Re=0,Ne=1,Le=2,ke=3,Me=4,Be=5,Ue=6,He=7,Ge=8;Pe.EnumDWT_MouseShape={Default:Re,Hand:Ne,Crosshair:Le,Zoom:ke,NWResize:Me,EResize:Be,NResize:Ue,Resize:He,Move:Ge},Pe.EnumDWT_Language={English:0,French:1,Arabic:2,Spanish:3,Portuguese:4,German:5,Italian:6,Russian:7,Chinese:8};var je=1,Ve=2,Xe=3;Pe.EnumDWT_InitMsg={Info:je,Error:Ve,NotInstalledError:Xe};var ze=0,Ke=3,Je=3,Ye=4,qe=4,Ze=5;Pe.EnumDWT_Driver={TWAIN:ze,ICA:Ke,SANE:Je,TWAIN_AND_ICA:Ye,TWAIN_AND_TWAIN64:qe,TWAIN64:Ze},Pe.EnumDWT_CompressionType={TWCP_NONE:0,TWCP_PACKBITS:1,TWCP_GROUP31D:2,TWCP_GROUP31DEOL:3,TWCP_GROUP32D:4,TWCP_GROUP4:5,TWCP_JPEG:6,TWCP_LZW:7,TWCP_JBIG:8,TWCP_PNG:9,TWCP_RLE4:10,TWCP_RLE8:11,TWCP_BITFIELDS:12,TWCP_ZIP:13,TWCP_JPEG2000:14};var Qe=0,$e=1;Pe.EnumDWT_SelectionMode={Single:Qe,Multiple:$e},Pe.EnumDWT_ConfirmExitType={Cancel:0,Exit:1,SaveAndExit:2};var en=0,nn=1,rn=2,tn=3;Pe.EnumDWT_WebsocketReadyState={CONNECTING:en,OPEN:nn,CLOSING:rn,CLOSED:tn};Pe.EnumDWT_ServiceType={TwainService:1};var on=2,an=0,sn=1,un=2;Pe.EnumDWT_ExtImageInfo={"default":an,standard:sn,supported:un};var cn=c.navInfoSync,ln={isFunction:function(e){return e&&"function"==typeof e},isReturnSuccess:function(e){if(-2115===e._errorCode)return u;if(-2003===e._errorCode&&!c.DWT.IfHttpPostErrorNoWindow){var n=window.open("","ErrorMessage","height=500,width=750,top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no");null==n||n.document.writeln(e.HTTPPostResponseString)}return 0==e._errorCode?u:s},setErrorString:function(e){e._errorCode=e.getSWebTwain().ErrorCode,e._errorString=e.getSWebTwain().ErrorString},checkErrorString:function(e){return ln.setErrorString(e),ln.isReturnSuccess(e)},wrapperRet:function(e,n,r,t,o,i){if(ln.checkErrorString(e)){if(ln.isFunction(r))if(o){var a=e.getSWebTwain().HTTPPostResponseString;a&&""!=a?(e._errorCode=-2003,e._errorString="HTTP process error.",l.isFunction(t)&&t(e._errorCode,e._errorString,a)):r(a)}else{if(i)return r(n),!0;r()}}else ln.isFunction(t)&&(o?t(e._errorCode,e._errorString,e.getSWebTwain().HTTPPostResponseString):t(e._errorCode,e._errorString));return n},wrapperPromise:function(e,n){return ln.setErrorString(e),0==e._errorCode?l.Promise.resolve(n):l.Promise.reject({code:e._errorCode,message:e._errorString})},getImageType:$,replaceLocalFilename:function(e){var n=e;return cn.bFileSystem&&(n=decodeURI(n)),n},makeParams:function(){var e=arguments;return e===undefined||0===e.length?undefined:e}};l.checkErrorString=ln.checkErrorString,l.wrapperRet=ln.wrapperRet,l.setErrorString=ln.setErrorString,l.DynamicLoadAddonFuns=[],l.attachAddon=function(e){if(cn.bWin){var n,r=!c.navInfo.bOSx64||c.navInfo.bWOW64,t=e.getSWebTwain();n=r?"DynamicPdfCore_"+c.DWT.ActiveXPdfVersion+".dll":"DynamicPdfCorex64_"+c.DWT.ActiveXPdfVersion+".dll";try{t.GetAddOnVersion("pdf",n)["catch"]((function(){}))}catch(o){}l.each(l.DynamicLoadAddonFuns,(function(n){l.isFunction(n)&&n(e)}))}};function dn(e){var n=this;n._stwain=e,l.attachAxViewerPropertyUI(n),l.attachAxViewerFunctions(n),n._thumbnailViewer=null}l.attachProperty=function(e){var n=e,r=function(e,r,t){var o;0!==r&&1!==r?o=r:(o={},r&&(o.set=1==t?function(r){return r*=1,!l.isNumber(r)||isNaN(r)?(l.Errors.InvalidValue(n),s):(n.getSWebTwain()[e]=r,ln.checkErrorString(n))}:2==t?function(r){return l.isBoolean(r)?(n.getSWebTwain()[e]=r,ln.checkErrorString(n)):(l.Errors.InvalidValue(n),s)}:function(r){return l.isString(r)?(n.getSWebTwain()[e]=r,ln.checkErrorString(n)):(l.Errors.InvalidValue(n),s)})),o.get||(o.get=function(){var r=n.getSWebTwain()[e];return n._errorCode=n.getSWebTwain().ErrorCode,n._errorString=n.getSWebTwain().ErrorString,r}),e in n||Object.defineProperty(n,e,o)};r("ErrorCode",{get:function(e){return n._errorCode}}),r("ErrorString",{get:function(e){return n._errorString}}),r("LogLevel",{get:function(){var e=n.getSWebTwain().LogLevel;return n._errorCode=n.getSWebTwain().ErrorCode,n._errorString=n.getSWebTwain().ErrorString,e},set:function(e){var r=1*e;return!l.isNumber(r)||isNaN(r)?(l.Errors.InvalidValue(n),s):(n.getSWebTwain().LogLevel=r,ln.checkErrorString(n))}}),r("Manufacturer",1),r("ProductFamily",1),r("ProductKey",{get:function(){return c.DWT.ProductKey},set:function(e){var r=u,t=e;if(t=l.isString(t)?l.trim(t):"",c.DWT.ProductKey=t,c.Lib.License.reparseProductKey(),n.__licenseInfo=undefined,""==t)r=s,l.License.checkProductKey(n,{Core:u},s)||De(n);else{var o=c.DWT.licenseException;if(0!=o.code)return n._errorCode=o.code,n._errorString=o.message,r;n.__licenseInfo=undefined,n.GetLicenseInfo(t),r=ln.checkErrorString(n)}return r}}),r("ProductName",1),r("VersionInfo",1),r("BitDepth",1,1),r("Brightness",1,1),r("Contrast",1,1),r("CurrentSourceName",0),r("DataSourceStatus",0),r("DefaultSourceName",0),r("Duplex",0),r("IfAppendImage",1,2),r("IfAutoBright",1,2),r("IfAutoDiscardBlankpages",1,2),r("IfAutoFeed",1,2),r("IfAutomaticBorderDetection",1,2),r("IfAutomaticDeskew",1,2),r("IfAutoScan",1,2),r("IfDisableSourceAfterAcquire",1,2),r("IfDuplexEnabled",1,2),r("IfFeederEnabled",1,2),r("IfModalUI",1,2),r("IfScanInNewThread",1,2),r("IfShowCancelDialogWhenImageTransfer",1,2),r("IfShowUI",1,2),r("IfShowIndicator",1,2),r("IfUseTwainDSM",1,2),r("IfFeederLoaded",0,2),r("IfPaperDetectable",0,2),r("IfUIControllable",0,2),r("ImageBitsPerPixel",0),r("ImageCaptureDriverType",1,1),r("ImageLayoutDocumentNumber",0),r("ImageLayoutFrameBottom",0),r("ImageLayoutFrameLeft",0),r("ImageLayoutFrameNumber",0),r("ImageLayoutFrameRight",0),r("ImageLayoutFrameTop",0),r("ImageLayoutPageNumber",0),r("ImageLength",0),r("ImagePixelType",0),r("ImageWidth",0),r("ImageXResolution",0),r("ImageYResolution",0),r("MagData",0),r("MagType",0),r("PageSize",1,1),r("PendingXfers",0),r("PixelFlavor",1,1),r("PixelType",1,1),r("Resolution",1,1),r("SourceCount",0),r("TransferMode",1,1),r("Unit",1,1),r("XferCount",1,1),r("Capability",1,1),r("CapCurrentIndex",1,1),r("CapCurrentValue",1,1),r("CapDefaultIndex",0),r("CapDefaultValue",0),r("CapDescription",1),r("CapMaxValue",1,1),r("CapMinValue",1,1),r("CapNumItems",1,1),r("CapStepSize",1,1),r("CapType",1,1),r("CapValue",1,1),r("CapValueString",1),r("CapValueType",1,1),r("AllowMultiSelect",1,2),r("BackgroundColor",1,1),r("BackgroundFillColor",1,1),r("BlankImageCurrentStdDev",0),r("BlankImageMaxStdDev",1,1),r("BlankImageThreshold",1,1),r("CurrentImageIndexInBuffer",{set:function(e){return e!=n.getSWebTwain().CurrentImageIndexInBuffer&&(n.getSWebTwain().CurrentImageIndexInBuffer=e),ln.checkErrorString(n)}}),r("FitWindowType",1,1),r("HowManyImagesInBuffer",0),r("IfFitWindow",1,2),r("ImageMargin",1,1),r("MaxImagesInBuffer",1,1),r("MouseX",0),r("MouseY",0),r("SelectionImageBorderColor",1),r("Zoom",1,1),r("MouseShape",1,2),r("SelectedImagesIndices",{get:function(){for(var e=[],r=n.getSWebTwain().SelectedImagesCount,t=0;t<r;t++)e.push(n.getSWebTwain().GetSelectedImageIndex(t));return e}}),r("HTTPPostResponseString",0),r("AsyncMode",1,2),r("FTPPassword",1),r("FTPPort",{set:function(e){return""!==e?(e*=1,n.getSWebTwain().FTPPort=e,ln.checkErrorString(n)):s}}),r("FTPUserName",1),r("HTTPPort",{set:function(e){return""!==e?(e*=1,n.getSWebTwain().HTTPPort=e,ln.checkErrorString(n)):(e=l.detect.ssl?443:80,n.getSWebTwain().HTTPPort=e,ln.checkErrorString(n))}}),r("HTTPPassword",1),r("HTTPUserName",1),r("IfPASVMode",1,2),r("IfShowProgressBar",1,2),r("ProxyServer",1),r("IfShowFileDialog",1,2),r("IfTiffMultiPage",1,2),r("PDFAuthor",1),r("PDFCompressionType",1,1),r("PDFCreationDate",1),r("PDFCreator",1),r("PDFKeywords",1),r("PDFModifiedDate",1),r("PDFProducer",1),r("PDFSubject",1),r("PDFTitle",1),r("PDFVersion",1),r("TIFFCompressionType",1,1),r("JPEGQuality",{set:function(e){return(e*=1)>=100?e=100:e<0&&(e=0),n.getSWebTwain().JPEGQuality=e,ln.checkErrorString(n)}}),r("HttpContentTypeFieldValue",1),r("SelectionRectAspectRatio",1,1),r("IfAllowLocalCache",1,2),r("_AutoCropMethod",1,2),r("BrokerProcessType",1,1),r("BorderStyle",1,1),r("IfShowPrintUI",1,2),r("VScrollBar",1,2),r("EnableInteractiveZoom",1,2),r("ImageEditorIfEnableEnumerator",1,2),r("ImageEditorIfReadonly",1,2),r("ImageEditorIfModal",1,2),r("ImageEditorWindowTitle",1),r("IfSSL",1,2),r("AllowPluginAuthentication",1,2),r("HttpFieldNameOfUploadedImage",1),r("MaxInternetTransferThreads",1,1),r("MaxUploadImageSize",1,1),r("IfOpenImageWithGDIPlus",1,2),r("BufferMemoryLimit",1,1),r("Width",{get:function(){return n.getSWebTwain().style.width},set:function(e){return n._ChangeWidth(e),ln.checkErrorString(n)}}),r("Height",{get:function(){return n.getSWebTwain().style.height},set:function(e){return n._ChangeHeight(e),ln.checkErrorString(n)}}),r("IfThrowException",1,2),r("IfAutoScroll",1,2),r("ShowPageNumber",{get:function(){return s},set:function(e){return s}}),r("UseLocalService",{get:function(){return!0}})},l.attachMethod=function(e){var n=e,r=function(e){return l.License.checkProductKey(n,{Core:u})?u:(l.isFunction(e)&&e(n.ErrorCode,n.ErrorString),s)},t=function(e,r){return l.License.checkPDFProductKeyWhenNeeds(n,e)?u:(l.isFunction(r)&&r(n.ErrorCode,n.ErrorString),s)},o=function(e,n){return 0!=e.HowManyImagesInBuffer||(l.Errors.NoImage(e),l.isFunction(n)&&n(e.ErrorCode,e.ErrorString),!1)},i=function(e,n,r){return!!o(e,r)&&(!(isNaN(n)||!l.isNumber(n)||n<0||n>=e.HowManyImagesInBuffer)||(l.Errors.IndexOutOfRange(e),l.isFunction(r)&&r(e.ErrorCode,e.ErrorString),!1))};e.UnregisterEvent=function(e,r){if(!l.isString(e))return l.Errors.InvalidEventName(n),!1;if("onwsmessage"===e.toLowerCase())return l.Errors.InvalidEventName(n),!1;if("OnPostAllTransfers"===e)return n.__OnPostAllTransfers=null,!0;if("OnBufferChanged"===e)return n.__OnBufferChanged=null,!0;if("OnBitmapChanged"===e)return n.__OnBitmapChanged=null,!0;n.getSWebTwain().UnregisterEvent(e,(function(){}));var t=["__",e].join("");return n[t]=null,ln.checkErrorString(n)},e.RegisterEvent=function(e,r){if(!l.isString(e))return l.Errors.InvalidEventName(n),!1;var t=e.toLowerCase();if("onwsmessage"===t)return l.Errors.InvalidEventName(n),!1;if(l.isFunction(r)){if("onpostalltransfers"===t)return n.__OnPostAllTransfers=r,!0;if("onbufferchanged"===t)return n.__OnBufferChanged=r,!0;if("onbitmapchanged"===t)return n.__OnBitmapChanged=r,!0;var o=["__",e].join("");return n[o]=r,n.getSWebTwain().RegisterEvent(e,r),ln.checkErrorString(n)}return!0},e.onEvent=function(e,r){return n.RegisterEvent(e,r)},e.on=function(e,r){return n.RegisterEvent(e,r)},e.CancelAllPendingTransfers=function(){return n.getSWebTwain().CancelAllPendingTransfers(),ln.checkErrorString(n)},e.CloseSource=function(){return n.getSWebTwain().CloseSource(),ln.checkErrorString(n)},e.CloseSourceManager=function(){return n.getSWebTwain().CloseSourceManager(),ln.checkErrorString(n)},e.DisableSource=function(){return n.getSWebTwain().DisableSource(),ln.checkErrorString(n)},e.FeedPage=function(){return n.getSWebTwain().FeedPage(),ln.checkErrorString(n)},e.GetDeviceType=function(){var e=n.getSWebTwain().GetDeviceType();return ln.setErrorString(n),e},e.GetSourceNameItems=function(e){var r=n.getSWebTwain().GetSourceNameItems(e);return ln.setErrorString(n),r},e.SourceNameItems=function(e){var r=n.getSWebTwain().GetSourceNameItems(e);return ln.setErrorString(n),r},e.GetSourceNames=function(){var r,t,o=[];for(r=n.getSWebTwain().SourceCount,t=0;t<r;t++){var i=e.GetSourceNameItems(t);o.push(i)}return o},e.GetSourceType=function(e){var r=n.getSWebTwain().GetSourceType(e);return ln.setErrorString(n),r},e.OpenSource=function(){return n.getSWebTwain().OpenSource(),ln.checkErrorString(n)},e.OpenSourceManager=function(){return n.getSWebTwain().OpenSourceManager(),ln.checkErrorString(n)},e.ResetImageLayout=function(){return n.getSWebTwain().ResetImageLayout(),ln.checkErrorString(n)},e.RewindPage=function(){return n.getSWebTwain().RewindPage(),ln.checkErrorString(n)},e.SelectSource=function(e,r){return l.isUndefined(e)?(n.getSWebTwain().SelectSource(),ln.checkErrorString(n)):(n.getSWebTwain().SelectSource(),ln.checkErrorString(n)?(e(),!0):(r(),!1))},e.SelectSourceByIndex=function(e){return n.getSWebTwain().SelectSourceByIndex(e),ln.checkErrorString(n)},e.CloseSourceAsync=function(){return ln.wrapperPromise(n,n.CloseSource())},e.CloseSourceManagerAsync=function(){return ln.wrapperPromise(n,n.CloseSourceManager())},e.GetSourceNamesAsync=function(){return ln.wrapperPromise(n,n.GetSourceNames())},e.GetSourceTypeAsync=function(e){return ln.wrapperPromise(n,n.GetSourceType(e))},e.OpenSourceAsync=function(){return ln.wrapperPromise(n,n.OpenSource())},e.OpenSourceManagerAsync=function(){return ln.wrapperPromise(n,n.OpenSourceManager())},e.SelectSourceAsync=function(e){return e&&0==(e&ee.TWAINSCANNER)&&0==(e&ee.WIATWAINSCANNER)?(l.Errors.InvalidParameter(n),l.Promise.reject({code:n._errorCode,message:n._errorString})):ln.wrapperPromise(n,n.SelectSource())},e.SelectSourceByIndexAsync=function(e){return ln.wrapperPromise(n,n.SelectSourceByIndex(e))},e.SetFileXferInfo=function(e,r){var t=ln.replaceLocalFilename(e);return n.getSWebTwain().SetFileXferInfo(t,r),ln.checkErrorString(n)},e.SetImageLayout=function(e,r,t,o){return n.getSWebTwain().SetImageLayout(e,r,t,o),ln.checkErrorString(n)},e.CapGet=function(){var e=n.getSWebTwain().CapGet();return ln.setErrorString(n),e},e.CapGetCurrent=function(){var e=n.getSWebTwain().CapGetCurrent();return ln.setErrorString(n),e},e.CapGetDefault=function(){var e=n.getSWebTwain().CapGetDefault();return ln.setErrorString(n),e},e.CapGetFrameBottom=function(e){var r=n.getSWebTwain().CapGetFrameBottom(e);return ln.setErrorString(n),r},e.CapGetFrameLeft=function(e){var r=n.getSWebTwain().CapGetFrameLeft(e);return ln.setErrorString(n),r},e.CapGetFrameRight=function(e){var r=n.getSWebTwain().CapGetFrameRight(e);return ln.setErrorString(n),r},e.CapGetFrameTop=function(e){var r=n.getSWebTwain().CapGetFrameTop(e);return ln.setErrorString(n),r},e.CapGetHelp=function(){var e=n.getSWebTwain().CapGetHelp();return ln.setErrorString(n),e},e.CapGetLabel=function(){var e=n.getSWebTwain().CapGetLabel();return ln.setErrorString(n),e},e.CapGetLabels=function(){var e=n.getSWebTwain().CapGetLabels();return ln.setErrorString(n),e},e.CapIfSupported=function(e){var r=n.getSWebTwain().CapIfSupported(e);return ln.setErrorString(n),r},e.CapReset=function(){return n.getSWebTwain().CapReset(),ln.checkErrorString(n)},e.CapSet=function(){return n.getSWebTwain().CapSet(),ln.checkErrorString(n)},e.CapSetFrame=function(e,r,t,o,i){return n.getSWebTwain().CapSetFrame(e,r,t,o,i),ln.checkErrorString(n)},e.GetCapItems=function(e){var r=n.getSWebTwain().GetCapItems(e);return ln.setErrorString(n),r},e.GetCapItemsString=function(e){var r=n.getSWebTwain().GetCapItemsString(e);return ln.setErrorString(n),r},e.SetCapItems=function(e,r){return n.getSWebTwain().SetCapItems(e,r),ln.checkErrorString(n)},e.SetCapItemsString=function(e,r){return n.getSWebTwain().SetCapItemsString(e,r),ln.checkErrorString(n)},e.AddText=function(e,r,t,o,i,a,s,u){var c=parseInt(e);return isNaN(c)||c<0||c>=n.HowManyImagesInBuffer?(l.Errors.IndexOutOfRange(n),!1):(n.getSWebTwain().AddText(c,r,t,o,i,a,s,u),ln.checkErrorString(n))},e.CreateTextFont=function(e,r,t,o,i,a,s,u,c,l,d,f,g,T){return n.getSWebTwain().CreateTextFont(e,r,t,o,i,a,s,u,c,l,d,f,g,T),ln.checkErrorString(n)},e.CopyToClipboard=function(e){var r=parseInt(e);return isNaN(r)||r<0||r>=n.HowManyImagesInBuffer?(l.Errors.IndexOutOfRange(n),!1):(n.getSWebTwain().CopyToClipboard(r),ln.checkErrorString(n))},e.Erase=function(e,r,t,o,i,a,s){var u,c=parseInt(e);return isNaN(c)||c<0||c>=n.HowManyImagesInBuffer?(l.Errors.IndexOutOfRange(n),l.isFunction(s)&&s(n.ErrorCode,n.ErrorString),!1):(u=n.getSWebTwain().Erase(c,r,t,o,i),ln.wrapperRet(n,u,a,s))},e.GetImageBitDepth=function(e){var r=parseInt(e);if(isNaN(r)||r<0||r>=n.HowManyImagesInBuffer)return l.Errors.IndexOutOfRange(n),!1;var t=n.getSWebTwain().GetImageBitDepth(r);return ln.setErrorString(n),t},e.GetImageWidth=function(e){var r=parseInt(e);if(isNaN(r)||r<0||r>=n.HowManyImagesInBuffer)return l.Errors.IndexOutOfRange(n),!1;var t=n.getSWebTwain().GetImageWidth(r);return ln.setErrorString(n),t},e.GetImageHeight=function(e){var r=parseInt(e);if(isNaN(r)||r<0||r>=n.HowManyImagesInBuffer)return l.Errors.IndexOutOfRange(n),!1;var t=n.getSWebTwain().GetImageHeight(r);return ln.setErrorString(n),t},e.GetImageSize=function(e,r,t){var o=parseInt(e);if(isNaN(o)||o<0||o>=n.HowManyImagesInBuffer)return l.Errors.IndexOutOfRange(n),!1;var i=n.getSWebTwain().GetImageSize(o,r,t);return ln.setErrorString(n),i},e.GetImageSizeWithSpecifiedType=function(e,r){var t=parseInt(e);if(isNaN(t)||t<0||t>=n.HowManyImagesInBuffer)return l.Errors.IndexOutOfRange(n),!1;var o=n.getSWebTwain().GetImageSizeWithSpecifiedType(t,r);return ln.setErrorString(n),o},e.GetImageXResolution=function(e){var r=parseInt(e);if(isNaN(r)||r<0||r>=n.HowManyImagesInBuffer)return l.Errors.IndexOutOfRange(n),!1;var t=n.getSWebTwain().GetImageXResolution(r);return ln.setErrorString(n),t},e.GetImageYResolution=function(e){var r=parseInt(e);if(isNaN(r)||r<0||r>=n.HowManyImagesInBuffer)return l.Errors.IndexOutOfRange(n),!1;var t=n.getSWebTwain().GetImageYResolution(r);return ln.setErrorString(n),t},e.CopyToClipboardAsync=function(e){return ln.wrapperPromise(n,n.CopyToClipboard(e))},e.EraseAsync=function(e,r,t,o,i){return ln.wrapperPromise(n,n.Erase(e,r,t,o,i))},e.GetImageBitDepthAsync=function(e){return ln.wrapperPromise(n,n.GetImageBitDepth(e))},e.GetImageWidthAsync=function(e){return ln.wrapperPromise(n,n.GetImageWidth(e))},e.GetImageHeightAsync=function(e){return ln.wrapperPromise(n,n.GetImageHeight(e))},e.GetImageSizeAsync=function(e,r,t){return ln.wrapperPromise(n,n.GetImageSize(e,r,t))},e.GetImageSizeWithSpecifiedTypeAsync=function(e,r){return ln.wrapperPromise(n,n.GetImageSizeWithSpecifiedType(e,r))},e.GetImageXResolutionAsync=function(e){return ln.wrapperPromise(n,n.GetImageXResolution(e))},e.GetImageYResolutionAsync=function(e){return ln.wrapperPromise(n,n.GetImageYResolution(e))},e.SelectAllImages=function(){var e,r=n.getSWebTwain().HowManyImagesInBuffer,t=[];for(n.getSWebTwain().SelectedImagesCount=r,e=0;e<r;e++)n.getSWebTwain().SetSelectedImageIndex(e,e),t.push(e);return ln.checkErrorString(n),t},e.SelectImages=function(e){var r=e.length;n.getSWebTwain().SelectedImagesCount=r;for(var t=0;t<r;t++)n.getSWebTwain().SetSelectedImageIndex(t,e[t]);return ln.checkErrorString(n)},e.GetSelectedImagesSize=function(e){var r=n.getSWebTwain().GetSelectedImagesSize(e);return ln.setErrorString(n),r},e.GetSkewAngle=function(e,r,t){var o,i=parseInt(e);return isNaN(i)||i<0||i>=n.HowManyImagesInBuffer?(l.Errors.IndexOutOfRange(n),l.isFunction(t)&&t(n.ErrorCode,n.ErrorString),!1):(o=n.getSWebTwain().GetSkewAngle(i),ln.wrapperRet(n,o,r,t,!1,!0))},e.GetSkewAngleEx=function(e,r,t,o,i,a,s){var u,c=parseInt(e);return isNaN(c)||c<0||c>=n.HowManyImagesInBuffer?(l.Errors.IndexOutOfRange(n),l.isFunction(s)&&s(n.ErrorCode,n.ErrorString),!1):(u=n.getSWebTwain().GetSkewAngleEx(c,r,t,o,i),ln.wrapperRet(n,u,a,s))},e.IsBlankImage=function(e){var r=parseInt(e);if(isNaN(r)||r<0||r>=n.HowManyImagesInBuffer)return l.Errors.IndexOutOfRange(n),!1;var t=n.getSWebTwain().IsBlankImage(r);return ln.setErrorString(n),t},e.IsBlankImageEx=function(e,r,t,o,i,a){var s=parseInt(e);if(isNaN(s)||s<0||s>=n.HowManyImagesInBuffer)return l.Errors.IndexOutOfRange(n),!1;var u=n.getSWebTwain().IsBlankImageEx(s,r,t,o,i,a);return ln.setErrorString(n),u},e.Mirror=function(e,r,t){var o,i=parseInt(e);return isNaN(i)||i<0||i>=n.HowManyImagesInBuffer?(l.Errors.IndexOutOfRange(n),l.isFunction(t)&&t(n.ErrorCode,n.ErrorString),!1):(o=n.getSWebTwain().Mirror(i),ln.wrapperRet(n,o,r,t))},e.OverlayRectangle=function(e,r,t,o,i,a,s){return n.getSWebTwain().OverlayRectangle(e,r,t,o,i,a,s),ln.checkErrorString(n)},e.RemoveAllImages=function(){var e;return n.getSWebTwain().RemoveAllImages(),(e=ln.checkErrorString(n))&&n.__innerRefreshImage(),n.Width=parseInt(n.Width)+2,e},e.RemoveAllSelectedImages=function(){var e;return n.getSWebTwain().RemoveAllSelectedImages(),(e=ln.checkErrorString(n))&&n.__innerRefreshImage(),e},e.RemoveImage=function(e){var r=parseInt(e);return isNaN(r)||r<0||r>=n.HowManyImagesInBuffer?(l.Errors.IndexOutOfRange(n),!1):(n.getSWebTwain().RemoveImage(r),ln.checkErrorString(n))},e.MirrorAsync=function(e){return ln.wrapperPromise(n,n.Mirror(e))},e.RemoveAllImagesAsync=function(){return ln.wrapperPromise(n,n.RemoveAllImages())},e.RemoveAllSelectedImagesAsync=function(){return ln.wrapperPromise(n,n.RemoveAllSelectedImages())},e.RemoveImageAsync=function(e){return ln.wrapperPromise(n,n.RemoveImage(e))},e.Rotate=function(e,r,t,o,i){var a,s=parseInt(e);return isNaN(s)||s<0||s>=n.HowManyImagesInBuffer?(l.Errors.IndexOutOfRange(n),l.isFunction(i)&&i(n.ErrorCode,n.ErrorString),!1):(a=n.getSWebTwain().Rotate(s,r,t),ln.wrapperRet(n,a,o,i))},e.RotateEx=function(e,r,t,o,i,a){var s,u=parseInt(e);return isNaN(u)||u<0||u>=n.HowManyImagesInBuffer?(l.Errors.IndexOutOfRange(n),l.isFunction(a)&&a(n.ErrorCode,n.ErrorString),!1):(s=n.getSWebTwain().RotateEx(u,r,t,o),ln.wrapperRet(n,s,i,a))},e.RotateLeft=function(e,r,t){var o,i=parseInt(e);return isNaN(i)||i<0||i>=n.HowManyImagesInBuffer?(l.Errors.IndexOutOfRange(n),l.isFunction(t)&&t(n.ErrorCode,n.ErrorString),!1):(o=n.getSWebTwain().RotateLeft(i),ln.wrapperRet(n,o,r,t))},e.RotateRight=function(e,r,t){var o,i=parseInt(e);return isNaN(i)||i<0||i>=n.HowManyImagesInBuffer?(l.Errors.IndexOutOfRange(n),l.isFunction(t)&&t(n.ErrorCode,n.ErrorString),!1):(o=n.getSWebTwain().RotateRight(i),ln.wrapperRet(n,o,r,t))},e.ChangeImageSize=function(e,r,t,o,i,a){var s,u=parseInt(e);return isNaN(u)||u<0||u>=n.HowManyImagesInBuffer?(l.Errors.IndexOutOfRange(n),l.isFunction(a)&&a(n.ErrorCode,n.ErrorString),!1):r<=0||t<=0?(l.Errors.InvalidWidthOrHeight(n),l.isFunction(a)&&a(n.ErrorCode,n.ErrorString),!1):(s=n.getSWebTwain().ChangeImageSize(u,r,t,o),ln.wrapperRet(n,s,i,a))},e.Flip=function(e,r,t){var o,i=parseInt(e);return isNaN(i)||i<0||i>=n.HowManyImagesInBuffer?(l.Errors.IndexOutOfRange(n),l.isFunction(t)&&t(n.ErrorCode,n.ErrorString),!1):(o=n.getSWebTwain().Flip(i),ln.wrapperRet(n,o,r,t))},e.Crop=function(e,r,t,o,i,a,s){var u,c=parseInt(e);return isNaN(c)||c<0||c>=n.HowManyImagesInBuffer?(l.Errors.IndexOutOfRange(n),l.isFunction(s)&&s(n.ErrorCode,n.ErrorString),!1):(u=n.getSWebTwain().Crop(c,r,t,o,i),ln.wrapperRet(n,u,a,s))},e.CropToClipboard=function(e,r,t,o,i){var a=parseInt(e);return isNaN(a)||a<0||a>=n.HowManyImagesInBuffer?(l.Errors.IndexOutOfRange(n),!1):(n.getSWebTwain().CropToClipboard(a,r,t,o,i),ln.checkErrorString(n))},e.CutFrameToClipboard=function(e,r,t,o,i){var a=parseInt(e);return isNaN(a)||a<0||a>=n.HowManyImagesInBuffer?(l.Errors.IndexOutOfRange(n),!1):(n.getSWebTwain().CutFrameToClipboard(a,r,t,o,i),ln.checkErrorString(n))},e.CutToClipboard=function(e){var r=parseInt(e);return isNaN(r)||r<0||r>=n.HowManyImagesInBuffer?(l.Errors.IndexOutOfRange(n),!1):(n.getSWebTwain().CutToClipboard(r),ln.checkErrorString(n))},e.RotateAsync=function(e,r,t){return ln.wrapperPromise(n,n.Rotate(e,r,t))},e.RotateExAsync=function(e,r,t,o){return ln.wrapperPromise(n,n.RotateEx(e,r,t,o))},e.RotateLeftAsync=function(e){return ln.wrapperPromise(n,n.RotateLeft(e))},e.RotateRightAsync=function(e){return ln.wrapperPromise(n,n.RotateRight(e))},e.ChangeImageSizeAsync=function(e,r,t,o){return ln.wrapperPromise(n,n.ChangeImageSize(e,r,t,o))},e.FlipAsync=function(e){return ln.wrapperPromise(n,n.Flip(e))},e.CropAsync=function(e,r,t,o,i){return ln.wrapperPromise(n,n.Crop(e,r,t,o,i))},e.CropToClipboardAsync=function(e,r,t,o,i){return ln.wrapperPromise(n,n.CropToClipboard(e,r,t,o,i))},e.CutFrameToClipboardAsync=function(e,r,t,o,i){return ln.wrapperPromise(n,n.CutFrameToClipboard(e,r,t,o,i))},e.CutToClipboardAsync=function(e){return ln.wrapperPromise(n,n.CutToClipboard(e))},e.InvertAsync=function(e){return ln.wrapperPromise(n,n.Invert(e))},e.Invert=function(e){var r=parseInt(e);return isNaN(r)||r<0||r>=n.HowManyImagesInBuffer?(l.Errors.IndexOutOfRange(n),!1):(l.Errors.ActiveXNotSupport(n),!1)},e.SetDPI=function(e,r,t,o,i,a,s){var u,c=parseInt(e);return isNaN(c)||c<0||c>=n.HowManyImagesInBuffer?(l.Errors.IndexOutOfRange(n),l.isFunction(s)&&s(n.ErrorCode,n.ErrorString),!1):(u=n.getSWebTwain().SetDPI(c,r,t,o,i),ln.wrapperRet(n,u,a,s))},e.SetViewMode=function(e,r){return n.getSWebTwain().SetViewMode(e,r),ln.checkErrorString(n)},e.GetViewModeH=function(){var e=n.getSWebTwain().GetViewModeH();return ln.setErrorString(n),e},e.GetViewModeV=function(){var e=n.getSWebTwain().GetViewModeV();return ln.setErrorString(n),e},e.MoveImage=function(e,r){var t=parseInt(e),o=parseInt(r);return isNaN(t)||t<0||t>=n.HowManyImagesInBuffer||isNaN(o)||o<0||o>=n.HowManyImagesInBuffer?(l.Errors.IndexOutOfRange(n),!1):(n.getSWebTwain().MoveImage(t,o),ln.checkErrorString(n))},e.SwitchImage=function(e,r){var t=parseInt(e),o=parseInt(r);return isNaN(t)||t<0||t>=n.HowManyImagesInBuffer||isNaN(o)||o<0||o>=n.HowManyImagesInBuffer?(l.Errors.IndexOutOfRange(n),!1):(n.getSWebTwain().SwitchImage(t,o),ln.checkErrorString(n))},e.Print=function(){return n.getSWebTwain().Print(),ln.checkErrorString(n)},e.checkErrorString=function(){return ln.isReturnSuccess(n)},e.FileExists=function(e){var r=ln.replaceLocalFilename(e),t=n.getSWebTwain().FileExists(r);return ln.setErrorString(n),t},e.SaveAllAsMultiPageTIFF=function(e,r,t){if(!o(n,t))return!1;var i,a=ln.replaceLocalFilename(e);return i=n.getSWebTwain().SaveAllAsMultiPageTIFF(a),ln.wrapperRet(n,i,r,t)},e.SaveAllAsPDF=function(e,r,t){if(!o(n,t))return!1;var i,a=ln.replaceLocalFilename(e);return i=n.getSWebTwain().SaveAllAsPDF(a),ln.wrapperRet(n,i,r,t)},e.SaveAsBMP=function(e,r,t,o){if(!i(n,r,o))return!1;var a,s=ln.replaceLocalFilename(e);return a=n.getSWebTwain().SaveAsBMP(s,r),ln.wrapperRet(n,a,t,o)},e.SaveAsJPEG=function(e,r,t,o){if(!i(n,r,o))return!1;var a,s=ln.replaceLocalFilename(e);return a=n.getSWebTwain().SaveAsJPEG(s,r),ln.wrapperRet(n,a,t,o)},e.SaveAsPDF=function(e,r,t,o){if(!i(n,r,o))return!1;var a,s=ln.replaceLocalFilename(e);return a=n.getSWebTwain().SaveAsPDF(s,r),ln.wrapperRet(n,a,t,o)},e.SaveAsPNG=function(e,r,t,o){if(!i(n,r,o))return!1;var a,s=ln.replaceLocalFilename(e);return a=n.getSWebTwain().SaveAsPNG(s,r),ln.wrapperRet(n,a,t,o)},e.SaveAsTIFF=function(e,r,t,o){if(!i(n,r,o))return!1;var a,s=ln.replaceLocalFilename(e);return a=n.getSWebTwain().SaveAsTIFF(s,r),ln.wrapperRet(n,a,t,o)},e.SaveSelectedImagesAsMultiPagePDF=function(e,r,t){var o,i=ln.replaceLocalFilename(e);return o=n.getSWebTwain().SaveSelectedImagesAsMultiPagePDF(i),ln.wrapperRet(n,o,r,t)},e.SaveSelectedImagesAsMultiPageTIFF=function(e,r,t){var o,i=ln.replaceLocalFilename(e);return o=n.getSWebTwain().SaveSelectedImagesAsMultiPageTIFF(i),ln.wrapperRet(n,o,r,t)},e.SaveSelectedImagesToBase64Binary=function(e,r){var t=n.getSWebTwain().SaveSelectedImagesToBase64Binary();return ln.wrapperRet(n,t,e,r)},e.ShowFileDialog=function(e,r,t,o,i,a,s,u){return n.getSWebTwain().ShowFileDialog(e,r,t,o,i,a,s,u),ln.checkErrorString(n)},e.FTPDownload=function(e,t,o,i){if(!r(i))return!1;var a=n.getSWebTwain().FTPDownload(e,t);return a&&l.License.isLTS()&&c.DWT.lcvrf(n),ln.wrapperRet(n,a,o,i)},e.FTPDownloadDirectly=function(e,t,o,i,a){if(!r(a))return!1;var s=n.getSWebTwain().FTPDownloadDirectly(e,t,o);return ln.wrapperRet(n,s,i,a)},e.FTPDownloadEx=function(e,o,i,a,u){if(!r(u))return!1;if(i!=c.DWT.EnumDWT_ImageType.IT_BMP&&i!=c.DWT.EnumDWT_ImageType.IT_JPG&&i!=c.DWT.EnumDWT_ImageType.IT_TIF&&i!=c.DWT.EnumDWT_ImageType.IT_PNG&&i!=c.DWT.EnumDWT_ImageType.IT_PDF&&i!=c.DWT.EnumDWT_ImageType.IT_J2K&&(i=-1),!t(i,u))return s;var l=n.getSWebTwain().FTPDownloadEx(e,o,i);return ln.wrapperRet(n,l,a,u)},e.FTPUpload=function(e,t,o,i,a){if(!r(a))return!1;var s=n.getSWebTwain().FTPUpload(e,t,o);return ln.wrapperRet(n,s,i,a)},e.FTPUploadDirectly=function(e,t,o,i,a){if(!r(a))return!1;var s=n.getSWebTwain().FTPUploadDirectly(e,t,o);return ln.wrapperRet(n,s,i,a)},e.FTPUploadEx=function(e,t,o,i,a,s){if(!r(s))return!1;var u=n.getSWebTwain().FTPUploadEx(e,t,o,i);return ln.wrapperRet(n,u,a,s)},e.FTPUploadAllAsMultiPageTIFF=function(e,t,o,i){if(!r(i))return!1;var a=n.getSWebTwain().FTPUploadAllAsMultiPageTIFF(e,t);return ln.wrapperRet(n,a,o,i)},e.FTPUploadAllAsPDF=function(e,t,o,i){if(!r(i))return!1;var a=n.getSWebTwain().FTPUploadAllAsPDF(e,t);return ln.wrapperRet(n,a,o,i)},e.FTPUploadAsMultiPagePDF=function(e,r,t,o){var i=n.getSWebTwain().FTPUploadAsMultiPagePDF(e,r);return ln.wrapperRet(n,i,t,o)},e.FTPUploadAsMultiPageTIFF=function(e,r,t,o){var i=n.getSWebTwain().FTPUploadAsMultiPageTIFF(e,r);return ln.wrapperRet(n,i,t,o)},e.HTTPDownloadDirectly=function(e,t,o,i,a){if(!r(a))return!1;var s=n.getSWebTwain().HTTPDownloadDirectly(e,t,o);return ln.wrapperRet(n,s,i,a)},e.HTTPDownload=function(e,r,t,o){var i=ln.getImageType(r);return n.HTTPDownloadEx(e,r,i,t,o)},e.HTTPDownloadEx=function(e,o,i,a,u){if(!r(u))return s;if(i!=c.DWT.EnumDWT_ImageType.IT_BMP&&i!=c.DWT.EnumDWT_ImageType.IT_JPG&&i!=c.DWT.EnumDWT_ImageType.IT_TIF&&i!=c.DWT.EnumDWT_ImageType.IT_PNG&&i!=c.DWT.EnumDWT_ImageType.IT_PDF&&i!=c.DWT.EnumDWT_ImageType.IT_J2K&&(i=-1),!t(i,u))return s;var d=n.getSWebTwain().HTTPDownloadEx(e,o,i);return d&&l.License.isLTS()&&c.DWT.lcvrf(n),ln.wrapperRet(n,d,a,u)},e.HTTPDownloadThroughGet=e.HTTPDownloadEx,e.HTTPUploadThroughPostDirectly=function(e,t,o,i,a,s){if(!r(s))return!1;var u=n.getSWebTwain().HTTPUploadThroughPostDirectly(e,t,o,i);return ln.wrapperRet(n,u,a,s,!0)},e.HTTPUploadThroughPost=function(e,r,t,o,i,a){if(!l.isNumber(r)||isNaN(r)||r<-2)return l.Errors.IndexOutOfRange(n),l.isFunction(a)&&a(n.ErrorCode,n.ErrorString),!1;var s=n.getSWebTwain().HTTPUploadThroughPost(e,r,t,o);return ln.wrapperRet(n,s,i,a,!0)},e.HTTPUploadThroughPostEx=function(e,r,t,o,i,a,s){if(!l.isNumber(r)||isNaN(r)||r<-2)return l.Errors.IndexOutOfRange(n),l.isFunction(s)&&s(n.ErrorCode,n.ErrorString),!1;var u=n.getSWebTwain().HTTPUploadThroughPostEx(e,r,t,o,i);return ln.wrapperRet(n,u,a,s,!0)},e.ClearAllHTTPFormField=function(){return n.getSWebTwain().ClearAllHTTPFormField(),ln.checkErrorString(n)},e.SetHTTPFormField=function(e,r){return n.getSWebTwain().SetHTTPFormField(e,r),ln.checkErrorString(n)},e.HTTPUploadAllThroughPostAsMultiPageTIFF=function(e,r,t,o,i){var a;return a=n.getSWebTwain().HTTPUploadAllThroughPostAsMultiPageTIFF(e,r,t),ln.wrapperRet(n,a,o,i,!0)},e.HTTPUploadThroughPostAsMultiPageTIFF=function(e,r,t,o,i){var a;return a=n.getSWebTwain().HTTPUploadThroughPostAsMultiPageTIFF(e,r,t),ln.wrapperRet(n,a,o,i,!0)},e.HTTPUploadAllThroughPostAsPDF=function(e,r,t,o,i){var a;return a=n.getSWebTwain().HTTPUploadAllThroughPostAsPDF(e,r,t),ln.wrapperRet(n,a,o,i,!0)},e.HTTPUploadThroughPostAsMultiPagePDF=function(e,r,t,o,i){var a;return a=n.getSWebTwain().HTTPUploadThroughPostAsMultiPagePDF(e,r,t),ln.wrapperRet(n,a,o,i,!0)},e.HTTPUploadThroughPutDirectly=function(e,r,t,o,i){var a;return a=n.getSWebTwain().HTTPUploadThroughPutDirectly(e,r,t),ln.wrapperRet(n,a,o,i)},e.HTTPUploadThroughPut=function(e,r,t,o,i){var a=ln.getImageType(t);return n.HTTPUploadThroughPutEx(e,r,t,a,o,i)},e.HTTPUploadThroughPutEx=function(e,r,t,o,i,a){var s;return s=n.getSWebTwain().HTTPUploadThroughPutEx(e,r,t,o),ln.wrapperRet(n,s,i,a)},e.HTTPUploadAllThroughPutAsMultiPageTIFF=function(e,r,t,o){return n.HTTPUploadThroughPutEx(e,-1,r,2,t,o)},e.HTTPUploadThroughPutAsMultiPageTIFF=function(e,r,t,o){return n.HTTPUploadThroughPutEx(e,-2,r,2,t,o)},e.HTTPUploadAllThroughPutAsPDF=function(e,r,t,o){return n.HTTPUploadThroughPutEx(e,-1,r,4,t,o)},e.HTTPUploadThroughPutAsMultiPagePDF=function(e,r,t,o){return n.HTTPUploadThroughPutEx(e,-2,r,4,t,o)},e.ShowImageEditor=function(){return n.getSWebTwain().ShowImageEditor(),ln.checkErrorString(n)},e.SetCookie=function(e){return n.getSWebTwain().SetCookie(e),ln.checkErrorString(n)},e.LoadImageFromBase64Binary=function(e,o,i,a){if(!r())return s;if(o!=c.DWT.EnumDWT_ImageType.IT_BMP&&o!=c.DWT.EnumDWT_ImageType.IT_JPG&&o!=c.DWT.EnumDWT_ImageType.IT_TIF&&o!=c.DWT.EnumDWT_ImageType.IT_PNG&&o!=c.DWT.EnumDWT_ImageType.IT_PDF&&o!=c.DWT.EnumDWT_ImageType.IT_J2K&&(o=-1),!t(o))return l.isFunction(a)&&a(n._errorCode,n._errorString),s;var u=n.getSWebTwain().LoadImageFromBase64Binary(e,o);return ln.setErrorString(n),u?l.isFunction(i)&&i():l.isFunction(a)&&a(n._errorCode,n._errorString),u},e.SaveSelectedImagesToBytes=function(e,r){var t=n.getSWebTwain().SaveSelectedImagesToBytes(e,r);return ln.setErrorString(n),t},e.LoadImageFromBytes=function(e,o,i){if(!r())return s;if(i!=c.DWT.EnumDWT_ImageType.IT_BMP&&i!=c.DWT.EnumDWT_ImageType.IT_JPG&&i!=c.DWT.EnumDWT_ImageType.IT_TIF&&i!=c.DWT.EnumDWT_ImageType.IT_PNG&&i!=c.DWT.EnumDWT_ImageType.IT_PDF&&i!=c.DWT.EnumDWT_ImageType.IT_J2K&&(i=-1),!t(i))return s;var a=n.getSWebTwain().LoadImageFromBytes(e,o,i);return ln.setErrorString(n),a},e.SetImageWidth=function(e,r,t,o){var i,a=parseInt(e);return isNaN(a)||a<0||a>=n.HowManyImagesInBuffer?(l.Errors.IndexOutOfRange(n),l.isFunction(o)&&o(n.ErrorCode,n.ErrorString),!1):(i=n.getSWebTwain().SetImageWidth(a,r),ln.wrapperRet(n,i,t,o))},e.HTTPDownloadThroughPost=function(e,o,i,a,u){if(!r(u))return!1;if(i!=c.DWT.EnumDWT_ImageType.IT_BMP&&i!=c.DWT.EnumDWT_ImageType.IT_JPG&&i!=c.DWT.EnumDWT_ImageType.IT_TIF&&i!=c.DWT.EnumDWT_ImageType.IT_PNG&&i!=c.DWT.EnumDWT_ImageType.IT_PDF&&i!=c.DWT.EnumDWT_ImageType.IT_J2K&&(i=-1),!t(i,u))return s;var l=n.getSWebTwain().HTTPDownloadThroughPost(e,o,i);return ln.wrapperRet(n,l,a,u)},e.SetCustomDSDataEx=function(e){return n.getSWebTwain().SetCustomDSDataEx(e),ln.checkErrorString(n)},e.SetCustomDSData=function(e){return n.getSWebTwain().SetCustomDSData(e),ln.checkErrorString(n)},e.GetCustomDSDataEx=function(){var e=n.getSWebTwain().GetCustomDSDataEx();return ln.setErrorString(n),e},e.GetCustomDSData=function(e){var r=n.getSWebTwain().GetCustomDSData(e);return ln.setErrorString(n),r},e.ChangeBitDepth=function(e,r,t){var o=parseInt(e);return isNaN(o)||o<0||o>=n.HowManyImagesInBuffer?(l.Errors.IndexOutOfRange(n),!1):(n.getSWebTwain().ChangeBitDepth(o,r,t),ln.checkErrorString(n))},e.ConvertToGrayScale=function(e,r,t){var o,i=parseInt(e);return isNaN(i)||i<0||i>=n.HowManyImagesInBuffer?(l.Errors.IndexOutOfRange(n),l.isFunction(t)&&t(n.ErrorCode,n.ErrorString),!1):(o=n.getSWebTwain().ConvertToGrayScale(e),ln.wrapperRet(n,o,r,t))},e.ShowImageEditorEx=function(e,r,t,o,i){return n.getSWebTwain().ShowImageEditorEx(e,r,t,o,i),ln.checkErrorString(n)},e.ClearTiffCustomTag=function(){return n.getSWebTwain().ClearTiffCustomTag(),ln.checkErrorString(n)},e.SetTiffCustomTag=function(e,r,t){var o=1*e;return c.Lib.isUndef(e)||c.Lib.isUndef(r)?(c.Lib.Errors.InvalidParameter(n),!1):o<=0||o>2147483647?(c.Lib.Errors.InvalidTiffTagError(n),!1):(n.getSWebTwain().SetTiffCustomTag(e,r,t),ln.checkErrorString(n))},e.IsBlankImageExpress=function(e){var r=parseInt(e);if(isNaN(r)||r<0||r>=n.HowManyImagesInBuffer)return l.Errors.IndexOutOfRange(n),!1;var t=n.getSWebTwain().IsBlankImageExpress(r);return ln.setErrorString(n),t},e._ChangeWidth=function(e){var r,t=document.getElementById(n._strDWTInnerContainerID);if(l.isString(e)&&e.length>0&&"%"===e.charAt(e.length-1)&&(r=e),!r){var o=parseInt(e);o&&o>2&&(r=o-2+"px")}return r&&(n._strWidth=r,n.getSWebTwain().style.width=r,t&&(t.style.width=r)),u},e._ChangeHeight=function(e){var r,t=document.getElementById(n._strDWTInnerContainerID);if(l.isString(e)&&e.length>0&&"%"===e.charAt(e.length-1)&&(r=e),!r){var o=parseInt(e);o&&(r=o+"px")}return r&&(n._strHeight=r,n.getSWebTwain().style.height=r,t&&(t.style.height=r)),u},e.SetSize=function(e,n){return this._ChangeWidth(e),this._ChangeHeight(n),u},e.SetSelectedImageArea=function(e,r,t,o,i){return n.getSWebTwain().SetSelectedImageArea(e,r,t,o,i),ln.checkErrorString(n)},e.SetVideoRotateMode=function(e){return n.getSWebTwain().SetVideoRotateMode(e),ln.checkErrorString(n)},e.SetOpenSourceTimeout=function(e){return n.getSWebTwain().SetOpenSourceTimeout(e),ln.checkErrorString(n)},e.SetHTTPHeader=function(e,n){return!1},e.GetImageURL=function(e,n,r){return""},e.GetImagePartURL=function(e){var r=parseInt(e);if(isNaN(r)||r<0||r>=n.HowManyImagesInBuffer)return l.Errors.IndexOutOfRange(n),"";var t=n.getSWebTwain().GetDIB(r);return ln.setErrorString(n),t},e.GetLicenseInfo=function(e){try{var r,t=!1;if(l.License.isLTS())t=!0,r=n.getSWebTwain().GetLicenseInfo();else if(l.isString(e))if(l.License.isLicenseMixed(e)){var o=c.DWT.licenseException;n._errorCode=o.code,n._errorString=o.message}else l.License.isLongKey(e)?(n.getSWebTwain().ProductKey=e,r=n.getSWebTwain().GetLicenseInfo()):l.Errors.LicenseEmptyOrInvalid(n);else l.Errors.LicenseEmptyOrInvalid(n);if(r&&ln.checkErrorString(n)){var i=l.parse(r);if(i&&i.message)l.Errors.LicenseEmptyOrInvalid(n),n._errorString=i.message,i=undefined;else if(t){if(i&&l.isArray(i.Detail)&&i.Detail.length>0){var a=i.Detail[0].ExpireDate;c.DWT.lsexp(c.DWT.EnumInstance.dwt_desktop,a,"")}i.LTS=!0}u=i,(s=n).__licenseInfo=u,function(e){e.__calic||(e.__calic=e.__licenseInfo)}(s)}else n.__licenseInfo=undefined}catch(d){n.__licenseInfo=undefined}var s,u;return Promise.resolve(n.__licenseInfo)},e.LoadDibFromClipboard=function(e,r){var t=n.getSWebTwain().LoadDibFromClipboard();return t&&l.License.isLTS()&&c.DWT.lcvrf(n),ln.wrapperRet(n,t,e,r)},e.LoadImage=function(e,t,o){if(!r(o))return!1;var i,a=ln.replaceLocalFilename(e);return(i=n.getSWebTwain().LoadImage(a))&&l.License.isLTS()&&c.DWT.lcvrf(n),ln.wrapperRet(n,i,t,o)},e.LoadImageEx=function(e,o,i,a){if(!r(a))return s;if(o!=c.DWT.EnumDWT_ImageType.IT_BMP&&o!=c.DWT.EnumDWT_ImageType.IT_JPG&&o!=c.DWT.EnumDWT_ImageType.IT_TIF&&o!=c.DWT.EnumDWT_ImageType.IT_PNG&&o!=c.DWT.EnumDWT_ImageType.IT_PDF&&o!=c.DWT.EnumDWT_ImageType.IT_J2K&&(o=-1),!t(o,a))return s;var u,d=ln.replaceLocalFilename(e),f=o;return f==c.DWT.EnumDWT_ImageType.IT_ALL&&(f=-1),(u=n.getSWebTwain().LoadImageEx(d,f))&&l.License.isLTS()&&c.DWT.lcvrf(n),ln.wrapperRet(n,u,i,a)},e.EnableSource=function(e,r,t){return this.AcquireImage(e,r,t),ln.checkErrorString(n)},e.AcquireImage=function(e,t,o){var i,a,s,u=n.getSWebTwain();if(l.isUndefined(o)&&(l.isFunction(e)&&l.isFunction(t)||l.isFunction(e)&&l.isUndefined(t)||l.isFunction(e)&&null==t||null==e&&l.isFunction(t))?(i=null,l.isFunction(e)&&(a=e),l.isFunction(t)&&(s=function(){t(n._errorCode,n._errorString)})):(i=l.isUndefined(e)||null==e?{}:l.clone(e),l.isFunction(t)&&(a=function(){t(i)}),l.isFunction(o)&&(s=function(){o(i,n._errorCode,n._errorString)})),!r(s))return!1;var d,f=!1;i!==undefined&&null!==i&&(null!=(d=i.SelectSourceByIndex)&&void 0!==d&&(u.SelectSourceByIndex(d),u.CloseSource()),u.OpenSource(),null!=(d=i.IfShowUI)&&void 0!==d&&(u.IfShowUI=d),null!=(d=i.PixelType)&&void 0!==d&&(u.PixelType=d),null!=(d=i.Resolution)&&void 0!==d&&(u.Resolution=d),null!=(d=i.IfFeederEnabled)&&void 0!==d&&(u.IfFeederEnabled=d),null!=(d=i.IfDuplexEnabled)&&void 0!==d&&(u.IfDuplexEnabled=d),null!=(d=i.IfDisableSourceAfterAcquire)&&void 0!==d&&(u.IfDisableSourceAfterAcquire=d),null!=(d=i.IfCloseSourceAfterAcquire)&&void 0!==d&&(f=!!d));return n.getSWebTwain().RegisterEvent("OnPostTransferAsync",(function(e){var r;e&&l.isString(e)&&(r=l.parse(e)),l.isFunction(n.__OnPostTransferAsync)&&n.__OnPostTransferAsync(r)})),n.getSWebTwain().RegisterEvent("OnPostAllTransfers",(function(){ln.checkErrorString(n)?(l.License.isLTS()&&c.DWT.lcvrf(n),l.isFunction(a)&&a()):l.isFunction(s)&&s(n._errorCode,n._errorString),l.isFunction(n.__OnPostAllTransfers)&&n.__OnPostAllTransfers(),f&&u.CloseSource()})),u.AcquireImage(),ln.checkErrorString(n)},e.AcquireImageAsync=function(){var e=V(Z.mark((function r(e){var t;return Z.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e?l.clone(e):{},r.abrupt("return",new c.Lib.Promise((function(e,r){n.AcquireImage(t,(function(){e(!0)}),(function(){r({code:n._errorCode,message:n._errorString})}))})));case 2:case"end":return r.stop()}}),r)})));return function(n){return e.apply(this,arguments)}}(),e.GetDevicesAsync=function(e,r,t){var o,i=null!=e?e:re,a=null!=r&&r,s=null!=t&&t;return o=function(e,n){var r,t=[],o=n;if(l.isString(o)&&(o=l.parse(o)),l.isArray(o))for(r=0;r<o.length;r++){var i=ue(o[r]);t.push(i)}for(r=0;r<t.length;r++){var a=t[r],s=a.deviceType;a.strDevice=l.stringify(a),a.name&&(a.name=l.base64.decode(a.name)),s&ne&&a.deviceInfo&&se(a.deviceInfo),a.serviceInfo=null==e?void 0:e._dmService,ae(a,null==e?void 0:e._dmService)}return t}(null,o=n.getSWebTwain().GetDevices(i,a,s)),ln.wrapperPromise(n,o)},e.SelectDeviceAsync=function(e,r){var t,o=null!=r?r:We.SMF_NAME;if(n._resetErr(),!(e&&e instanceof ie))throw l.Errors.InvalidParameter(n),{code:n._errorCode,message:n._errorString};return t=n.getSWebTwain().SelectDevice(e.strDevice,o),ln.wrapperPromise(n,t)},e.GenerateURLForUploadData=function(e,r,t){var o=e;return o==c.DWT.EnumDWT_ImageType.IT_ALL&&(o=-1),!0,ln.wrapperRet(n,true,r,t)},e._innerFun=function(e,r,t){var o=n.getSWebTwain(),i=o[e];return"function"==typeof i?i.apply(o,r):i},e.ActiveUI=function(e,n){},e.startScan=function(){return new l.Promise((function(e,n){}))},e.IndexToImageID=function(e){return e},e.ImageIDToIndex=function(e){return e},e.first=function(){return n.HowManyImagesInBuffer>0&&(n.CurrentImageIndexInBuffer=0,n.__innerRefreshImage()),u},e.previous=function(){var e;return n.HowManyImagesInBuffer>0&&(e=n.CurrentImageIndexInBuffer)>0&&(n.CurrentImageIndexInBuffer=e-1,n.__innerRefreshImage()),u},e.next=function(){var e,r=n.HowManyImagesInBuffer;return r>0&&(e=n.CurrentImageIndexInBuffer)>=0&&e<r-1&&(n.CurrentImageIndexInBuffer=e+1,n.__innerRefreshImage()),u},e.last=function(){var e=n.HowManyImagesInBuffer;return e>0&&(n.CurrentImageIndexInBuffer=e-1,n.__innerRefreshImage()),u},e.isUsingActiveX=function(){return!0},e.show=function(){return e.ShowImageEditor()},e.SetLTSInfo=function(e,r){return n.getSWebTwain().SetLTSInfo(e,r)},e.EnableBuffer=function(e){return n.getSWebTwain().Encrypt(e,0)},e.GetBuffer=function(e){return n.getSWebTwain().GetBuffer(e)},e.GetUUID=function(){return n.getSWebTwain().GetUUID()},e.__OnDispatchThumbnailEvt=function(n,r,t){1==t?l.isFunction(e["__"+n+"_Thumbnail"])&&("OnMouseClick"==n||"OnMouseDoubleClick"==n||"OnMouseMove"==n||"OnMouseWheel"==n||"OnKeyDown"==n?e["__"+n+"_Thumbnail"]():e["__"+n+"_Thumbnail"](r)):l.isFunction(e["__"+n])&&e["__"+n](r)},e._OnImageAreaSelected=function(n,r,t,o,i,a){var s="OnImageAreaSelected";1==a?l.isFunction(e["__"+s+"_Thumbnail"])&&e["__"+s+"_Thumbnail"](n,r,t,o,i):l.isFunction(e["__"+s])&&e["__"+s](n,r,t,o,i)};var a=function(e,n){(l.isFunction(e["__"+n])||l.isFunction(e["__"+n+"_Thumbnail"]))&&("OnImageAreaSelected"==n?e.getSWebTwain().RegisterEvent(n,e._OnImageAreaSelected):e.getSWebTwain().RegisterEvent(n,(function(r,t){return e.__OnDispatchThumbnailEvt(n,r,t)})))};e.getSourceCount=function(e){return l.Errors.ActiveXNotSupport(n),l.Promise.resolve(n.getSWebTwain().SourceCount)},e.GetSourceCountAsync=function(e){return l.Errors.ActiveXNotSupport(n),l.Promise.resolve(n.getSWebTwain().SourceCount)},e._resetErr=function(){this._errorCode=0,this._errorString="";var e=c.DWT.licenseException;e.code=0,e.message=""},e._setConvertModeInner=function(e){if(!l.License.checkProductKey(n,{Core:u}))return!1;var r=1*e;return n._resetErr(),isNaN(r)?(l.Errors.ParameterCannotEmpty(n),!1):1!=r&&2!=r&&3!=r&&4!=r?(l.Errors.InvalidValue(n),!1):(n._pdfConvertMode=r,2==r||l.License.hasPDFRProductKey(n)?n._pdfRealConvertMode=r:n._pdfRealConvertMode=2,!0)},e._setConvertMode=function(e){return!!n._setConvertModeInner(e)&&(n.getSWebTwain().SetPDFConvertMode(n._pdfRealConvertMode),!(2==n._pdfRealConvertMode&&1==n._pdfConvertMode||2==n._pdfRealConvertMode&&4==n._pdfConvertMode)||(l.Errors.LicenseNoPDF(n),!1))},e._axNotSupportAsync=function(e){var n=this;return l.Errors.ActiveXNotSupport(n),l.Promise.reject({code:n.ErrorCode,message:n.ErrorString})},e.ConvertToBase64=function(e,n,r,t){var o,i,a=this,s=e;s=l.isArray(s)?s.join(","):-1;var u,c=a.getSWebTwain().SaveImagesToBase64(s,n,(function(e,n){o=e,i=n}));return ln.checkErrorString(a)&&(u=new le(null,i,o,c)),ln.wrapperRet(a,[u,e,n],(function(e){r&&r(e[0],e[1],e[2])}),t,!1,!0)},e.ConvertToBlob=function(e,n,r,t){var o=this,i=e;i=l.isArray(i)?i.join(","):-1;var a=o.getSWebTwain().SaveImagesToBytes(i,n,(function(e,n){}));return ln.checkErrorString(o)&&(a=window.VBArray(a).toArray()),ln.wrapperRet(o,[a,e,n],(function(e){r&&r(e[0],e[1],e[2])}),t,!1,!0)},e._checkIndices=function(e){var n,r,t=this;if(!l.isArray(e))return l.Errors.IndicesNotArray(t),!1;if(0==e.length)return l.Errors.IndicesCannotEmpty(t),!1;if(c.DWT.ConnectWithSocket)return!0;for(n=t.HowManyImagesInBuffer,r=0;r<e.length;r++){var o=e[r];if(l.isUndefined(o)||null===o)return l.Errors.IndexNullOrUndefined(t),!1;if(o=parseInt(o),isNaN(o))return l.Errors.InvalidIndex(t),!1;if(o<0||o>=n)return l.Errors.IndicesOutOfRange(t),!1}return!0},e.HTTPUpload=function(e,n,r,t,o,i,a){var s=this,u=n,c=i,d=a,f=arguments;if(!s._checkIndices(n))return d(s._errorCode,s._errorString),!1;u=l.isArray(u)?u.join(","):-1;var g=s.IfSSL,T=s.HTTPPort,p=new l.Uri(e),h=p.scheme,m=p.port;l.isString(h)&&(h=h.toLowerCase()),"https"==h?(s.IfSSL=!0,s.HTTPPort=443):(s.IfSSL=!1,s.HTTPPort=80),m&&(s.HTTPPort=m);var _="RemoteFile";f.length>4&&(l.isFunction(o)?(c=o,f.length>5&&(d=i)):l.isString(o)&&(_=o));var I=s.getSWebTwain().HTTPUpload(p.hostname,u,p.path,_,r,t);return I=ln.wrapperRet(s,I,(function(e){l.isFunction(c)&&c(e,n,f)}),d,!0),s.IfSSL=g,s.HTTPPort=T,I},e.__innerRefreshImage=function(){var e,r=n.HowManyImagesInBuffer;r>0&&(e=n.CurrentImageIndexInBuffer,n.__OnRefreshUI&&n.__OnRefreshUI(e,r))},e.__OnBitmapChangedEx=function(r,t,o,i,a){var s=t,u=a;if(u>-1&&e._blts&&(1==s||2==s)){var d=c.DWT.lgct(u);l.isFunction(n.__OnLtsverify)&&n.__OnLtsverify(d,1)}if(l.isFunction(n.__OnBitmapChanged)&&n.__OnBitmapChanged(r,t,o,i),l.isFunction(n.__OnBufferChanged)){var f=n.CurrentImageIndexInBuffer,g={action:1==s||2==s?"add":3==s?"remove":4==s?"modify":5==s?"shift":"",currentId:f,imageIds:[],selectedIds:[]};-1!=f&&g.selectedIds.push(f),n.__OnBufferChanged(g)}},e._attachEvents=function(){var e,r=n.getSWebTwain();(e=Q(String(n.VersionInfo))).length<=2||e[0]<9||9==e[0]&&e[1]<=2||(""!=n.__OnPostTransfer&&r.RegisterEvent("OnPostTransfer",n.__OnPostTransfer),""!=n.__OnPostAllTransfers&&r.RegisterEvent("OnPostAllTransfers",n.__OnPostAllTransfers),""!=n.__OnPostLoad&&r.RegisterEvent("OnPostLoad",n.__OnPostLoad),a(n,"OnMouseClick"),a(n,"OnImageAreaSelected"),a(n,"OnTopImageInTheViewChanged"),a(n,"OnImageAreaDeSelected"),a(n,"OnMouseDoubleClick"),a(n,"OnMouseRightClick"),a(n,"OnMouseMove"),""!=n.__OnGetFilePath&&r.RegisterEvent("OnGetFilePath",n.__OnGetFilePath),""!=n.__OnAfterOperate&&r.RegisterEvent("OnAfterOperate",n.__OnAfterOperate),""!=n.__OnBeforeOperate&&r.RegisterEvent("OnBeforeOperate",n.__OnBeforeOperate),""!=n.__OnOperateStatus&&r.RegisterEvent("OnOperateStatus",n.__OnOperateStatus),r.RegisterEvent("OnBitmapChangedEx",n.__OnBitmapChangedEx),""!=n.__OnPreAllTransfers&&r.RegisterEvent("OnPreAllTransfers",n.__OnPreAllTransfers),""!=n.__OnPreTransfer&&r.RegisterEvent("OnPreTransfer",n.__OnPreTransfer),""!=n.__OnSourceUIClose&&r.RegisterEvent("OnSourceUIClose",n.__OnSourceUIClose),""!=n.__OnTransferCancelled&&r.RegisterEvent("OnTransferCancelled",n.__OnTransferCancelled),""!=n.__OnTransferError&&r.RegisterEvent("OnTransferError",n.__OnTransferError),""!=n.__OnInternetTransferPercentage&&r.RegisterEvent("OnInternetTransferPercentage",n.__OnInternetTransferPercentage),""!=n.__OnInternetTransferPercentageEx&&r.RegisterEvent("OnInternetTransferPercentageEx",n.__OnInternetTransferPercentageEx),a(n,"OnMouseWheel"),a(n,"OnKeyDown"),a(n,"OnPaintDone"))}},l.noControl=function(e){if(c.DWT.IfUseEmbeddedDownloadNoticeForActiveX)!function(e,n,r,t){var o,i,a=l.product,s=c.navInfoSync,u=!1;e&&(l.one(e).before(l.install._strNonInstallDIV),(o=l.get(l.install._divDWTNonInstallContainerID))&&(o.style.width=n,o.style.height=r),l.show(l.install._divDWTNonInstallContainerID),l.hide(e));""!=l.install._divDWTemessageContainer&&l.hide(l.install._divDWTemessageContainer);if(i=c.dcp.getDSPath(),t){if(l.isFunction(c.OnWebTwainNeedUpgradeCallback)){var d={"default":i};c.OnWebTwainNeedUpgradeCallback(a.name,d,a.bHTML5Edition,xe.enumWindow,s.bIE,s.bSafari,l.detect.ssl,l.env.strIEVersion)}}else l.isFunction(c.OnWebTwainNotFoundOnWindowsCallback)&&c.OnWebTwainNotFoundOnWindowsCallback(a.name,i,a.bHTML5Edition,s.bIE,s.bSafari,l.detect.ssl,l.env.strIEVersion,u)}(e._containerElement,e._strWidth,e._strHeight,!1);else{var n=l.product,r="";l.isFunction(c.OnWebTwainNotFoundOnWindowsCallback)&&(r=cn.bIE||n.bHTML5Edition?c.dcp.getDSPath():n.getMSIPath(),c.OnWebTwainNotFoundOnWindowsCallback(c.DWT.ProductName,r,n.bHTML5Edition,cn.bIE,cn.bSafari,l.detect.ssl,l.env.strIEVersion,!1))}},l.attachAxViewerPropertyUI=function(e){var n=function(n,r){n in e||Object.defineProperty(e,n,r)};n("width",{get:function(){return e._stwain.Width},set:function(n){return e._stwain.Width=n,l.checkErrorString(e._stwain)}}),n("height",{get:function(){return e._stwain.Height},set:function(n){return e._stwain.Height=n,l.checkErrorString(e._stwain)}}),n("background",{get:function(){return e._stwain.BackgroundColor},set:function(n){return e._stwain.BackgroundColor=n,n}}),n("cursor",{get:function(){return e._stwain.MouseShape?"pointer":"crosshair"},set:function(n){return e._stwain.MouseShape="pointer"==n,n}}),n("showPageNumber",{get:function(){return!1},set:function(e){return!1}}),n("ifAutoScroll",{get:function(){return e._stwain.IfAutoScroll},set:function(n){return e._stwain.IfAutoScroll=n,n}}),n("pageMargin",{get:function(){return e._stwain.ImageMargin},set:function(n){return e._stwain.ImageMargin=n,n}}),n("zoom",{get:function(){return e._stwain.Zoom},set:function(n){return e._stwain.Zoom=n,n}})},l.attachAxViewerFunctions=function(e){e.next=function(){return this._stwain.next()},e.previous=function(){return this._stwain.previous()},e.first=function(){return this._stwain.first()},e.last=function(){return this._stwain.last()},e.gotoPage=function(e){var n=this,r=1*e;return l.isNaN(r)||!l.isNumber(r)?(l.Errors.InvalidIndex(n._stwain),!1):r<0||r>=n._stwain.HowManyImagesInBuffer?(l.Errors.IndexOutOfRange(n._stwain),!1):(n._stwain.CurrentImageIndexInBuffer=r,r)},e.setSelectedAreas=function(e){return this._stwain.SetSelectedImageArea(this._stwain.CurrentImageIndexInBuffer,e.left,e.top,e.right,e.bottom)},e.fitWindow=function(e){var n=this;return"height"==e?(n._stwain.IfFitWindow=!0,n._stwain.FitWindowType=Oe):"width"==e?(n._stwain.IfFitWindow=!0,n._stwain.FitWindowType=Fe):(n._stwain.IfFitWindow=!0,n._stwain.FitWindowType=Ae),!0},e.setViewMode=function(e,n){return this._stwain.SetViewMode(e,n)},e.createImageEditor=function(){return this._stwain},e.on=function(e,n){var r,t=this;return""!=(r=t._convertEvtName(e))&&("OnImageAreaSelected"==r?(t.OnImageAreaSelected=function(e,r,t,o,i){n(e,[{x:r,y:t,width:o-r,height:i-t}])},t._stwain.RegisterEvent(r,t.OnImageAreaSelected)):t._stwain.RegisterEvent(r,n))},e.off=function(e,n){var r;return""!=(r=this._convertEvtName(e))&&this._stwain.UnregisterEvent(r,(function(){}))},e.createThumbnailViewer=function(e){var n=this;if(n._thumbnailViewer)l.Errors.ThumbnailViewerExist(n._stwain);else{var r=new l.UI.ThumbnailViewer(n._stwain,e);n._thumbnailViewer=r.getInstance()}return n._thumbnailViewer},e._convertEvtName=function(e){if(!l.isString(e))return"";var n=l.trim(e).toLowerCase();return"toppagechanged"==n?"OnTopImageInTheViewChanged":"click"==n?"OnMouseClick":"dblclick"==n?"OnMouseDoubleClick":"mousemove"==n?"OnMouseMove":"rightclick"==n?"OnMouseRightClick":"wheel"==n?"OnMouseWheel":"keydown"==n?"OnKeyDown":"pageareaselected"==n?"OnImageAreaSelected":"pageareaunselected"==n?"OnImageAreaDeSelected":l.trim(e)}},dn.prototype.getInstance=function(){return this};var fn={showThumbnail:!1,location:"horizontal",sequence:-1,size:"30%",columns:1,rows:3,scrollDirection:"vertical",pageMargin:10,border:"",allowKeyboardControl:!0,allowPageDragging:!0,allowResizing:!1,pageBackground:"transparent",pageBorder:"1px solid rgb(238, 238, 238)",hoverPageBackground:"rgb(239, 246, 253)",hoverPageBorder:"1px solid rgb(238, 238, 238)",placeholderBackground:"rgb(251, 236, 136)",autoChangeIndex:!1};function gn(e,n){var r=this,t=n;if(t){if(t.location)switch(t.location){case"left":default:t.location="horizontal",t.sequence=-1;break;case"right":t.location="horizontal",t.sequence=1;break;case"top":t.location="vertical",t.sequence=-1;break;case"bottom":t.location="vertical",t.sequence=1}else t.location="horizontal",t.sequence=-1;l.isUndefined(t.size)&&(t.size=fn.size),l.isUndefined(t.columns)&&(t.columns=fn.columns),l.isUndefined(t.rows)&&(t.rows=fn.rows),(l.isUndefined(t.scrollDirection)||"horizontal"!=t.scrollDirection)&&(t.scrollDirection=fn.scrollDirection),l.isUndefined(t.pageMargin)&&(t.pageMargin=fn.pageMargin),l.isUndefined(t.allowKeyboardControl)&&(t.allowKeyboardControl=fn.allowKeyboardControl),l.isUndefined(t.allowPageDragging)&&(t.allowPageDragging=fn.allowPageDragging),l.isUndefined(t.allowResizing)&&(t.allowResizing=fn.allowResizing),l.isUndefined(t.border)&&(t.border=fn.border),l.isUndefined(t.pageBackground)&&(t.pageBackground=fn.pageBackground),l.isUndefined(t.pageBorder)&&(t.pageBorder=fn.pageBorder),l.isUndefined(t.hoverPageBackground)&&(t.hoverPageBackground=fn.hoverPageBackground),l.isUndefined(t.hoverPageBorder)&&(t.hoverPageBorder=fn.hoverPageBorder),l.isUndefined(t.placeholderBackground)&&(t.placeholderBackground=fn.placeholderBackground),l.isUndefined(t.autoChangeIndex)&&(t.autoChangeIndex=fn.autoChangeIndex)}else t=fn;r._stwain=e,r._settings=t,l.attachViewerPropertyThumbnailUI(r),l.attachViewerFunctionsThumbnailUI(r),e.getSWebTwain().SetViewMode(-1,-1),e.getSWebTwain().ShowThumbnail(JSON.stringify(t))}gn.prototype.getInstance=function(){return this},l.attachViewerFunctionsThumbnailUI=function(e){e.show=function(){e._stwain?(e._stwain.getSWebTwain().SetViewMode(-1,-1),e._stwain.getSWebTwain().ShowThumbnail('{"mode":"show"}')):l.Errors.ThumbnailViewerDispose(e._stwain)},e.hide=function(){e._stwain?e._stwain.getSWebTwain().ShowThumbnail('{"mode":"hide"}'):l.Errors.ThumbnailViewerDispose(e._stwain)},e.dispose=function(){e.hide(),e._stwain=null},e.updateViewMode=function(n){if(e._stwain){if(n&&n.columns&&n.rows){if(n.columns<0||n.rows<0)return l.Errors.InvalidPropertyValue(e._stwain),!1;e._stwain.getSWebTwain().ShowThumbnail('{"columns":'+n.columns+',"rows":'+n.rows+"}")}}else l.Errors.ThumbnailViewerDispose(e._stwain)},e.on=function(n,r){var t=n,o=!1;l.isFunction(r)&&("click"==t&&(t="OnMouseClick"),"rightclick"==t&&(t="OnMouseRightClick"),"dblclick"==t&&(t="OnMouseDoubleClick"),"mousemove"==t&&(t="OnMouseMove"),"wheel"==t&&(t="OnMouseWheel"),"keydown"==t&&(t="OnKeyDown"),"toppagechanged"==t&&(t="OnTopImageInTheViewChanged"),"pageareaselected"==t&&(t="OnImageAreaSelected"),"pageareaunselected"==t&&(t="OnImageAreaDeSelected"),"OnMouseClick"==t||"OnMouseDoubleClick"==t||"OnMouseRightClick"==t||"OnMouseMove"==t||"OnMouseWheel"==t||"OnKeyDown"==t||"OnPaintDone"==t||"OnImageAreaDeSelected"==t||"OnTopImageInTheViewChanged"==t?(l.isFunction(e._stwain["__"+t])||l.isFunction(e._stwain["__"+t+"_Thumbnail"])||(o=!0),e._stwain["__"+t+"_Thumbnail"]=r,o&&e._stwain.getSWebTwain().RegisterEvent(t,(function(n,r){return e._stwain.__OnDispatchThumbnailEvt(t,n,r)}))):"OnImageAreaSelected"==t&&(l.isFunction(e._stwain["__"+t])||l.isFunction(e._stwain["__"+t+"_Thumbnail"])||(o=!0),e._stwain["__"+t+"_Thumbnail"]=r,o&&e._stwain.getSWebTwain().RegisterEvent(t,e._stwain._OnImageAreaSelected)))},e.off=function(n,r){e._stwain["__"+n+"_Thumbnail"]=""}},l.attachViewerPropertyThumbnailUI=function(e){var n=function(n,r){n in e||Object.defineProperty(e,n,r)};n("location",{get:function(){return e._settings.location},set:function(n){e._settings.location=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"location":"'+n+'"}')}}),n("size",{get:function(){return e._settings.size},set:function(n){e._settings.size=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"size":"'+n+'"}')}}),n("pageMargin",{get:function(){return e._settings.pageMargin},set:function(n){e._settings.pageMargin=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"pageMargin":"'+n+'"}')}}),n("background",{get:function(){return e._settings.background},set:function(n){e._settings.background=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"background":"'+n+'"}')}}),n("pageBackground",{get:function(){return e._settings.pageBackground},set:function(n){e._settings.pageBackground=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"pageBackground":"'+n+'"}')}}),n("selectedPageBorder",{get:function(){return e._settings.selectedPageBorder},set:function(n){e._settings.selectedPageBorder=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"selectedPageBorder":"'+n+'"}')}}),n("selectedPageBackground",{get:function(){return e._settings.selectedPageBackground},set:function(n){e._settings.selectedPageBackground=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"selectedPageBackground":"'+n+'"}')}}),n("scrollDirection",{get:function(){return e._settings.scrollDirection},set:function(n){e._settings.scrollDirection=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"scrollDirection":"'+n+'"}')}}),n("showPageNumber",{get:function(){return e._settings.showPageNumber},set:function(n){e._settings.showPageNumber=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"showPageNumber":"'+n+'"}')}}),n("border",{get:function(){return e._settings.border},set:function(n){e._settings.border=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"border":"'+n+'"}')}}),n("pageBorder",{get:function(){return e._settings.pageBorder},set:function(n){e._settings.pageBorder=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"pageBorder":"'+n+'"}')}}),n("hoverPageBackground",{get:function(){return e._settings.hoverPageBackground},set:function(n){e._settings.hoverPageBackground=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"hoverPageBackground":"'+n+'"}')}}),n("hoverPageBorder",{get:function(){return e._settings.hoverPageBorder},set:function(n){e._settings.hoverPageBorder=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"hoverPageBorder":"'+n+'"}')}}),n("placeholderBackground",{get:function(){return e._settings.placeholderBackground},set:function(n){e._settings.placeholderBackground=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"placeholderBackground":"'+n+'"}')}}),n("allowKeyboardControl",{get:function(){return e._settings.allowKeyboardControl},set:function(n){e._settings.allowKeyboardControl=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"allowKeyboardControl":"'+n+'"}')}}),n("allowPageDragging",{get:function(){return e._settings.allowPageDragging},set:function(n){e._settings.allowPageDragging=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"allowPageDragging":"'+n+'"}')}}),n("allowResizing",{get:function(){return e._settings.allowResizing},set:function(n){e._settings.allowResizing=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"allowResizing":"'+n+'"}')}}),n("autoChangeIndex",{get:function(){return e._settings.autoChangeIndex},set:function(n){e._settings.autoChangeIndex=n,e._stwain&&e._stwain.getSWebTwain().ShowThumbnail('{"autoChangeIndex":"'+n+'"}')}})},l.UI=l.UI||{},l.UI.DWTAxViewer=dn,l.UI.ThumbnailViewer=gn;var Tn=l.isString,pn=l.isArray,hn=l.each;function mn(e,n){if(Tn(n))e.push('"'),e.push(n),e.push('"');else if(pn(n)){var r=u;e.push("["),hn(n,(function(n){r?r=s:e.push(","),mn(e,n)})),e.push("]")}else n===undefined?e.push('""'):e.push(n)}function _n(){for(var e=[],n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];if(r.length>0)if(1===r.length){var o=r[0];e.push("["),mn(e,o),e.push("]")}else if(2===r.length){var i=r[0],a=r[1];e.push("["),mn(e,i),e.push(","),mn(e,a),e.push("]")}else mn(e,Array.prototype.slice.call(r));return e.join("")}function In(e){return e instanceof ArrayBuffer||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Uint8ClampedArray||e instanceof Float32Array||e instanceof Float64Array}var Sn=1;function vn(){return(++Sn).toString()}var wn=function(){function n(r,t){e(this,n),i(this,"m_server",""),i(this,"m_iUsingTime",0),i(this,"m_countMap",{}),i(this,"m_newConsum",!1),i(this,"m_mapSavedToDb",!1),this.clearData(),this.m_enumInstance=r,r==c.DWT.EnumInstance.dwt_desktop?(this.m_deploymentType="desktop",this.m_server=t):r==c.DWT.EnumInstance.dbr&&(this.m_deploymentType="browser",this.m_server="")}return o(n,[{key:"clearData",value:function(){this.m_iUsingTime=0,this.m_jvUsingTime=l.nil,this.m_countMap={},this.m_newConsum=!1,this.m_mapSavedToDb=!1,this.m_minExpiredTime=l.nil,this.m_maxExpiredTime=l.nil,this.m_cu=l.nil,this.m_ar=l.nil,this.m_ltsInstance=l.nil}},{key:"set_cu",value:function(e){this.m_cu=e}},{key:"get_cu",value:function(){return this.m_cu}},{key:"set_ar",value:function(e){this.m_ar=e}},{key:"get_ar",value:function(){return this.m_ar}},{key:"get_ltsInstance",value:function(e){return this.m_ltsInstance||(this.m_ltsInstance=e(this.m_enumInstance)),this.m_ltsInstance}},{key:"inited_ltsInstance",value:function(){return!!this.m_ltsInstance}},{key:"set_maxExpiredTime",value:function(e){this.m_maxExpiredTime=e}},{key:"get_maxExpiredTime",value:function(){return this.m_maxExpiredTime}},{key:"set_minExpiredTime",value:function(e){this.m_minExpiredTime=e}},{key:"get_minExpiredTime",value:function(){return this.m_minExpiredTime}},{key:"get_deploymentType",value:function(){return this.m_deploymentType}},{key:"get_enumDeploymentType",value:function(){return this.m_enumInstance}}]),n}();var En=c.DWT;En.LTS=En.LTS||{},En.licenseException={code:0,message:"",fromLTS:!1},En.bLTSOnline=!0,En.axInstance=undefined,En.lOnUpdateDWObj=[],En.EnumInstance={dwt_desktop:0,dwt_browser:1,dbr:2};var bn,yn,Wn,Cn=0,Dn={},Pn=!1,An=!1,On=!1,Fn=!1,xn=!1;function Rn(){var e=l.product.handshakeCode;return l.isString(e)||(e=""),e}function Nn(){var e=l.product.organizationID;return l.isNumber(e)?e=""+e:l.isString(e)||(e=""),e}function Ln(){return l.replaceAll(En.JSVersion,",",".")}function kn(e,n){var r=e;return r===l.nil&&(r=En.EnumInstance.dwt_desktop),r==En.EnumInstance.dbr?(Wn||(Wn=new wn(r,"")),Wn):(yn||(yn=new wn(r,"")),yn)}En.lupverfy=function(){kn(En.EnumInstance.dwt_desktop).get_ltsInstance(Bn),kn(En.EnumInstance.dbr).get_ltsInstance(Bn)},En.lsmid=function(e,n){kn(En.EnumInstance.dwt_desktop).set_cu(e)},En.lsar=function(e,n){kn(En.EnumInstance.dwt_desktop).set_ar(e)},En.lsmid2b=function(e){kn(En.EnumInstance.dwt_desktop).set_cu(e)},En.lgar=function(e,n){kn(e).get_ar()},En.laddDWTObj=function(e){var n=!1;l.each(En.lOnUpdateDWObj,(function(r){if(r==e)return n=!0,!1})),n||En.lOnUpdateDWObj.push(e)},En.lremoveDWTObj=function(e){l.each(En.lOnUpdateDWObj,(function(n,r){if(n==e)return En.lOnUpdateDWObj.splice(r,1),!1}))},En.lsendUpdateEvt=function(e,n){var r=[];if(l.each(En.lOnUpdateDWObj,(function(n){e==En.EnumInstance.dwt_desktop&&r.push(n)})),0==r.length)return l.Promise.resolve();var t,o=r[0];return o._bAx?(l.each(r,(function(n){n.SetLTSInfo(kn(e).get_ar(),kn(e).get_cu())})),o.GetLicenseInfo().then((function(r){r&&l.isArray(r.Detail)&&r.Detail.length>0&&En.lsexp(e,r.Detail[0].ExpireDate,n)}))):(t=o.SetLTSLicenseAsync(kn(e).get_ar()).then((function(r){r&&l.isArray(r.Detail)&&r.Detail.length>0&&En.lsexp(e,r.Detail[0].ExpireDate,n)})),l.each(r,(function(n,r){0!=r&&n.SetLTSLicenseAsync(kn(e).get_ar())})),t)},En.lgcb=function(){var e=c.navInfoSync,n=[];return e.bChrome?n.push("Chrome"):e.bFirefox?n.push("Firefox"):e.bEdge?n.push("Edge"):e.bIE?n.push("IE"):e.bSafari?n.push("Safari"):e.bOpera?n.push("Opera"):e.b360SE?n.push("360SE"):e.bTencentTraveler?n.push("TencentTraveler"):e.bMaxthon?n.push("Maxthon"):e.bMetaSr?n.push("MetaSr"):e.bTheWorld?n.push("TheWorld"):e.bUC?n.push("UC"):e.bHuaWeiBrowser&&n.push("HuaWeiBrowser"),n.push(e.strBrowserVersion),e.bWin?n.push("Windows"):e.bMac?n.push("Mac"):e.bLinux?n.push("Linux"):e.bAndroid?n.push("Android"):e.bChromeOS?n.push("ChromeOS"):e.bHarmonyOS?n.push("HarmonyOS"):l.env.bMobile?n.push("Mobile OS"):c.navInfo.bEmbed&&n.push("Embed OS"),n.join(" ")};var Mn={NetworkError:-2440,Timedout:-2441,JsonError:-2442,CorsError:-2443,Expired:-2445,LtsJsLoadError:-2446,UUIDError:-2447};function Bn(e){var n,r,t=l.product.licenseServer;if(t&&t.length>0)for(n=0;n<t.length;n++)r=t[n],l.endsWith(r,"/")||(t[n]=r+"/");var o={dm:location.origin?l.startsWith(location.origin,"http")?location.origin:"https://localhost":l.startsWith(location.href,"http")?location.href:"https://localhost",lf:l.localforage,btoa:l.btoa,atob:l.atob,sutlcb:function(){l.isFunction(En.lonsend)&&En.lonsend()},fol:En.OnFirstOffline,dwt:!0};if(e==En.EnumInstance.dwt_browser||e==En.EnumInstance.dbr?o.feab=En.lfeab_wasm:o.feab=En.lfeab_ax,!c.navInfoSync.bIE&&l.product.ltsDebug&&(o.debugLog=console.log),c.LTS&&c.LTS._)return c.LTS._.createLtsInstance(o);var i={},a=function(){return l.Promise.reject({code:Mn.LtsJsLoadError,message:"The dynamsoft.lts.js load failed."})};return i.i=a,i.s=a,i.caret=a,i}function Un(e,n){var r=null!=n?n:"",t=kn(e),o=t.get_enumDeploymentType();if(En.lclex(),t.get_ar()&&t.get_cu())return Promise.resolve({ar:t.get_ar(),cu:t.get_cu()});var i={pd:En.lgpd(e),v:Ln(),os:En.lgcb(),fn:En.DeviceFriendlyName||"",ls:l.product.licenseServer,sp:l.product.sessionPassword,l:l.License.getLTSLicense(),mnet:function(){return t.get_maxExpiredTime()},mxet:function(){return t.get_minExpiredTime()},fol:En.OnFirstOffline};return i.dt=t.get_deploymentType(),o==En.EnumInstance.dwt_desktop?i.lsu=t.get_cu():o==En.EnumInstance.dbr||(i.dwt=!0,""!=t.get_cu()&&(i.lsu=t.get_cu()),i.updateLicense=function(e){t.set_ar(e.ar),t.get_cu()||t.set_cu(e.cu),En.lsendUpdateEvt(o,r)}),t.get_ltsInstance(Bn).i(i).then((function(e){return t.get_ar()||t.set_ar(e.ar),t.get_cu()||t.set_cu(e.cu),e}))}function Hn(){return Date.now()}function Gn(e){var n=e?new Date(e):new Date,r="yyyy-MM-ddTHH:mm:ss.SSSZ",t={"M+":n.getUTCMonth()+1,"d+":n.getUTCDate(),"H+":n.getUTCHours(),"h+":n.getUTCHours()%12||12,"m+":n.getUTCMinutes(),"s+":n.getUTCSeconds(),"q+":Math.floor((n.getUTCMonth()+3)/3),"S+":n.getUTCMilliseconds()};for(var o in/(y+)/.test(r)&&(r=r.replace(RegExp.$1,(n.getUTCFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+o+")").test(r)&&(r=r.replace(RegExp.$1,1==RegExp.$1.length?t[o]:("000"+t[o]).substr(("000"+t[o]).length-RegExp.$1.length)));return r}En.lgpd=function(e){return c.navInfoSync.bWin&&e==En.EnumInstance.dwt_desktop?"dwt|dbr":"dwt"},En.lglic=Un,En.lgbuuid=function(){return""},En.lshow=function(){return{t:bn,t2:Cn,m:JSON.stringify(Dn)}},En.lgct=function(e){switch(e){case 0:return"3011";case 1:return"3012";case 2:return"3014";case 3:return"3013";case 4:return"3015";case 14:return"3016";case 3001:return"3001";case 3002:return"3002";case 3003:return"3003";case 3004:return"3004";case 3005:return"3005";case 3006:return"3006";case 3007:return"3007";case 3008:return"3008";case 3009:return"3009";case 5001:return"5001";case 4001:return"4001";case 4002:return"4002";case 4003:return"4003"}return""},En.lcvrf=function(e){e&&setTimeout((function(){En.lcvrf_(e)}),1)},En.lcvrf_=function(e){var n;n=En.EnumInstance.dwt_desktop;var r,t=En.DeviceFriendlyName||"",o=En.lgcb(),i=kn(n),a={hs:Rn(),og:Nn(),cu:i.get_cu(),fn:t,cw:"",os:o,v:Ln(),dt:i.get_deploymentType(),ed:"js"},s=function(e,n){var r,t,o=c.Lib,i=0;if(o.isString(e)&&""!=e&&"{}"!=e&&n&&o.isArray(n)&&!(n.length<1)){if(t=kn(n[0]),r=o.parse(e),En.lclex(),0==Cn){var a=Hn(),s="";Cn=a,bn=Gn(a),Dn={},i=0,o.each(r,(function(e,n){(n<i||0==i)&&(i=n,s=e)})),i>0&&t.get_ltsInstance(Bn).s(o.product.licenseServer,s,i,!0).then((function(){}),(function(e){}))}o.each(r,(function(e,n){var r=!1,a=parseInt(n);a>0&&a!=i&&(a+18e4<Hn()&&(r=!0),t.get_ltsInstance(Bn).s(o.product.licenseServer,e,n,r).then((function(){}),(function(e){})))}))}};if(a.pd=En.lgpd(n),r=JSON.stringify(a),!e._bAx){var u="GetBuffer",d=_n(l.replaceAll(r,'"','\\"')),f={cmd:u,cmdId:vn(),sFun:s,fFun:function(){},params:[n]};return e._innerSendByWS(u,d,f,null,!0)}s(e.GetBuffer(r),[n,""])},En.lavrf=function(e,n,r,t){var o=1;if(""!=e){n>1&&(o=n);var i=Hn();if(Cn>0&&Cn+18e4<i){An?(Dn={},En.lavrf__unload()):En.lavrf__(!0,r,t);var a=Hn()+1;Cn=a,bn=Gn(a),Dn={}}Pn=!0,An=!1,Dn[e]?Dn[e]+=o:Dn[e]=o,0==Cn&&En.lavrf__(!0,r,t)}},En.lavrf_=function(e,n,r){if(Pn){var t=1;e&&(t=e),setTimeout((function(){En.lavrf__(!1,n,r)}),t)}},En.lavrf__=function(e,n,r){var t,o,i,a=Hn(),s=!1,u=!!e,c=0,d=n;l.isUndefined(d)&&(d=En.EnumInstance.dwt_desktop),i=kn(d),Pn=!1,0==Cn&&(s=!0,Cn=a,bn=Gn(a)),t=Cn,o=bn;var f={};f.ut=o;var g={};if(l.each(Dn,(function(e,n){g[n]=e,e>0&&c++})),f.cts=g,u||t+18e4<a){u=!0;var T=Hn()+1;if(Cn=T,bn=Gn(T),Dn={},An=!1,0==c)return}else{if(0==c)return;An=!0}f.dur=s?1:180;var p,h=En.DeviceFriendlyName||"",m=En.lgcb(),_={hs:Rn(),og:Nn(),cu:i.get_cu(),fn:h,cw:"",os:m,v:Ln(),dt:i.get_deploymentType(),ed:"js",rcs:[f]};_.product=En.lgpd(n),p=JSON.stringify(_),l.product.ltsDebug&&Gn(),En.lclex(),i.get_ltsInstance(Bn).s(l.product.licenseServer,p,""+t,u).then((function(){}),(function(e){}))},En.lavrf__unload=function(){var e,n=Hn(),r=kn(En.EnumInstance.dwt_desktop),t=kn(En.EnumInstance.dbr);Pn=!1,0==Cn&&(Cn=n,bn=Gn(n)),e=Cn;var o=Hn()+1;Cn=o,bn=Gn(o),Dn={},An=!1,e+=1,En.lclex(),r.inited_ltsInstance()&&r.get_ltsInstance(Bn).s(l.product.licenseServer,false,""+e,true).then((function(){}),(function(e){})),t.inited_ltsInstance()&&t.get_ltsInstance(Bn).s(l.product.licenseServer,false,""+e,true).then((function(){}),(function(e){}))},En.lclex=function(){var e=En.licenseException;e.code=0,e.message="",e.httpResponse="",e.fromLTS=!1},En.li=function(e,n){var r;if(e.axInstance&&(En.axInstance=e.axInstance,En.axInstance))return r=En.axInstance.GetUUID(),l.product.ltsDebug&&l.log("ActiveX cu: "+r),kn(e.instanceMode).set_cu(r),r;return kn(e.instanceMode).get_cu()},En.lfeab_ax=function(e){return new l.Promise((function(n,r){var t="";if(En.axInstance)try{t=En.axInstance.Encrypt(e,0)}catch(o){}n(t)}))},En.lfeab_wasm=function(e){return l.Promise.resolve("")},En.lwsproc=function(e,n){try{e=l.parse(e)}catch(r){return void(n.fFun&&n.fFun(r))}"GetBuffer"==e.method?n.sFun&&e.result.length>0?n.sFun(e.result[0],n.params):n.sFun("",n.params):n.sFun&&n.sFun(e)},En.lsexp=function(e,n,r){var t,o=n;if(3==(t=(o=l.replaceAll(o,"/","-")).split("-")).length){var i=t[0],a=t[1],s=t[2];a.length<2&&(a=(a="00"+a).substr(a.length-2)),s.length<2&&(s=(s="00"+s).substr(s.length-2)),o=[i,a,s].join("-")}var u=[o,"T23:59:59.999Z"].join("");kn(e).set_minExpiredTime(u),kn(e).set_maxExpiredTime(u)},En.lunload=function(){En.lavrf__unload();var e=kn(En.EnumInstance.dwt_desktop),n=kn(En.EnumInstance.dbr);e.clearData(),n.clearData(),Cn=0,bn=l.nil,Dn={},An=!1,Pn=!1,On=!1,Fn=!1,xn=!1,En.lclex(),En.bLTSOnline=!0,En.axInstance=l.nil,En.lOnUpdateDWObj=[]},En.lcexp=function(e,n){return kn(e).get_ltsInstance(Bn).caret().then((function(){return!1}),(function(e){var n=En.licenseException,r="";return e instanceof Error||"message"in e?r=e.message:l.isString(e)&&(r=e),En.lsetException(Mn.Expired,r,!1),Fn||(Fn=!0,l.error(r),c.OnLTSLicenseError&&c.OnLTSLicenseError(l.License.getPublicLicenseContent(n.message),n.code)),!0}))},En.OnLicenseException=function(){var e=En.licenseException,n=e.message;if(l.isString(n)&&(n.indexOf("Error Code")>-1?n=l.replaceAll(n,"Error Code","error code"):n.indexOf("Error code")>-1&&(n=l.replaceAll(n,"Error code","error code"))),n.indexOf("(https://www.dynamsoft.com/purchase-center/)")>-1&&(n=n.replace("(https://www.dynamsoft.com/purchase-center/)","(https://www.dynamsoft.com/store/dynamic-web-twain/)"),e.message=n),n.indexOf("error code:")>-1){var r=n.substr(0,n.indexOf("message")),t=n.substr(n.indexOf("message"));r.indexOf("{")>-1&&(r=r.substr(r.indexOf("{")+1)),t.indexOf("}")>-1&&(t=t.substr(0,t.indexOf("}"))),r=l.replaceAll(r,"error code:",""),t=l.replaceAll(t,"message: ",""),En.lsetException(parseInt(r),t,!0),l.error(t),c.OnLTSLicenseError&&c.OnLTSLicenseError(l.License.getPublicLicenseContent(n),e.code)}else{if(!e.code){var o=Mn.NetworkError;n.indexOf("timed out")>-1||n.indexOf("timeout")>-1?o=Mn.Timedout:(n.indexOf("access-control-allow-origin")>-1||n.indexOf("cors")>-1)&&(o=Mn.CorsError),En.lsetException(o,n,!0)}if(l.error(e.message),e.code==Mn.LtsJsLoadError)return;c.OnLTSLicenseError&&c.OnLTSLicenseError(l.License.getPublicLicenseContent(e.message),e.code)}},En.lol=function(){return En.bLTSOnline},En.OnFirstOffline=function(e){En.bLTSOnline=!1},En.lpubdlg=function(e,n){if(l.isString(e)&&""!=e){if(e=l.atob(e),console&&console.warn,1==n)return On||(On=!0,c.OnLTSPublicLicenseWarning&&c.OnLTSPublicLicenseWarning(l.License.getPublicLicenseContent(e))),!0;2==n&&(On||(On=!0))}return!1},En.lcheckLic=function(e,n,r){var t=!1;if(n){if(l.isArray(n.Detail)&&n.Detail.length>0){var o=n.Detail[0].ExpireDate;return En.lsexp(e,o,r),En.lcexp(e,r).then((function(e){var r=!1;e?r=!0:1!=n.Trial&&2!=n.Trial||(r=En.lpubdlg(n.Message,n.Trial)),r||En.bLTSOnline||xn||(xn=!0,c.OnLTSConnectionWarning&&c.OnLTSConnectionWarning())}))}1!=n.Trial&&2!=n.Trial||(t=En.lpubdlg(n.Message,n.Trial))}return t||En.bLTSOnline||xn||(xn=!0,c.OnLTSConnectionWarning&&c.OnLTSConnectionWarning()),l.Promise.resolve()},En.lisValidID=function(e){if(l.isString(e)&&""!=e)return!0;var n,r=En.licenseException;return En.lsetException(Mn.UUIDError,"Failed to generate an ID for your device to license it: not enough permission.",!0),l.error(r.message),n=r.message,c.OnLTSLicenseError&&c.OnLTSLicenseError(n,r.code),!1},En.lsetException=function(e,n,r){var t=En.licenseException;t.code=e,t.message=n,l.isUndefined(r)||(t.fromLTS=r)},En.lgcuid=function(e){var n=c.DWT.li({instanceMode:e},"");return n?l.Promise.resolve(n):kn(e).get_ltsInstance(Bn).u().then((function(e){return c.DWT.lsmid(e,""),c.DWT.lsmid2b(e),e}))};var jn,Vn=c.navInfoSync,Xn=document;function zn(e){var n=this,r=e||{};n._id=r.id,n._containerID=(r.container?r.container.id:r.containerId)||"dwtcontrolContainer",n._containerElement=l.get(n._containerID),n._strWidth=r.width||270,n._strHeight=r.height||350,l.isString(n._strWidth)&&n._strWidth.indexOf("%")>0||(n._strWidth=[parseInt(n._strWidth),"px"].join("")),l.isString(n._strHeight)&&n._strHeight.indexOf("%")>0||(n._strHeight=[parseInt(n._strHeight),"px"].join("")),n._strObjectName=n._containerID+"_Obj",function(e,n){n&&c.Lib.each(["onAfterOperate","onBeforeOperate","onOperateStatus","onBitmapChanged","onGetFilePath","onImageAreaDeSelected","onImageAreaSelected","onMouseClick","onMouseDoubleClick","onMouseMove","onMouseRightClick","onPreAllTransfers","onPreTransfer","onPostLoad","onPostTransfer","onPostTransferAsync","onPreAllTransfersAsync","onPostAllTransfers","onSourceUIClose","onTopImageInTheViewChanged","onTransferCancelled","onTransferError","onInternetTransferPercentage","onInternetTransferPercentageEx","onRemoteScanStatusAsync","onKeyDown","onMouseWheel"],(function(r){e["__O"+r.substring(1)]=n[r]||""}))}(n,r),n.__OnAxReady=r.onAxReady,n.__OnAxNotInstalled=r.onAxNotInstalled,n.__OnRefreshUI=r.onRefreshUI||"",n._objectWebTwain=null,n._strDWTInnerContainerID=n._containerID+"_CID",n._strDWTNonInstallInnerContainerID=n._containerID+"_NonInstallCID",n.Addon={},n._pdfConvertMode=3,n._pdfRealConvertMode=3,n._bAx=!0,l.UI.DWTAxViewer&&(n.Viewer=new l.UI.DWTAxViewer(n))}function Kn(e){return e&&!l.isString(e)?u:s}(jn=zn.prototype).getSWebTwain=function(){return this._objectWebTwain},jn.getInstance=function(){return!!this._objectWebTwain&&this},jn._createControl=function(){var e,n,r=this,t=r._strWidth,o=r._strHeight;if(l.isString(t)&&(t=t.indexOf("%")>0?"100%":parseInt(t)+2+"px"),l.isString(o)&&(o=o.indexOf("%")>0?"100%":parseInt(o)+2+"px"),n=['<div id="',r._strDWTInnerContainerID,'" style="width:',t,";height:",o,'">'],Vn.bIE)c.DWT.ActiveXInstallWithCAB?n.push('<object id="',r._strObjectName,'" style="width:',r._strWidth,";height:",r._strHeight,';border:1px solid #AAAAAA"',' codebase="',Vn.bWin64?l.product.getActiveXCABx64Path():l.product.getActiveXCABx86Path(),"#version=",c.DWT.ActiveXVersion,'"',' classid="clsid:',l.product.strFullClassID,'" viewastext>','<param name="wmode" value="transparent"/>',"</object>"):n.push('<object id="',r._strObjectName,'" style="width:',r._strWidth,";height:",r._strHeight,';border:1px solid #AAAAAA"',' classid="clsid:',l.product.strFullClassID,'" viewastext>','<param name="wmode" value="transparent"/>',"</object>");else{var i=r._strWidth;l.isString(i)&&-1==i.indexOf("%")&&(i=parseInt(i)-2+"px"),n.push('<embed id="',r._strObjectName,'" style="display: inline; width:',i,";height:",r._strHeight,'" type="',l.product.strMIMEType,'"',' pluginspage="',Vn.bWin?l.product.getMSIPath():l.product.getPKGPath(),'"></embed>')}n.push('</div><div id="',r._strDWTNonInstallInnerContainerID,'" style="width: ',t,';display:none"></div>'),(e=r._containerElement)&&(e.innerHTML=n.join("")),r._objectWebTwain=l.get(r._strObjectName)},jn._createNonAllowedDivPlugin=function(){var e=this,n=l.get(e._strDWTNonInstallInnerContainerID);if(""==n.innerHTML){var r=e._strHeight;l.isString(r)&&-1==r.indexOf("%")&&(r=parseInt(r)-10+"px");var t=['<div style="display: block; border:1px solid black; width:',e._strWidth,";height:",r,'">','<div style="margin: 200px 0 0 0; padding: 5px; font-size: 16px;line-height: 30px; ">',"<div>The Component is not allowed to run on this site.</div>",'<div>Please click <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJeSURBVDhPvZRNSxthEMeX0mNpKS09tP04tdBqobT9WCGJ5kU9pIk5xB4KaoJGmoiNMS+IUiqNB08mjUoUN2vU3WyS9d+ZIbvEZREP0j8Mk5ln5sfs7jxRcM/6f8BKpYKZmRlEIhGUSiUYhjE8uV2eQIal0xmobQ3aeQc/CwWUy+Xh6e3yBM7OzuJMbcPs9cUYzNPeRQLc29tDKpVCOBx2LJ3JQDe66Jo9fI3HEY1GnTOurdVqAnBLgFxwcNBAp3N5w0yTJiTTtA5UVXPy9XpDerwkwOnpaZydtWma/p3s8OgYcZraSwIMhULoXFx6NntZvf4XyWRSAG45QO38wrO51x/Asq7F27nbJMBEIoFm8wiLS0uYm0s6j88QfXUF6ucJXNMe2lAWx+qXD3I+KgHu7OwgEAjI/q2vr2N5eUUaebIWwRovFLTG38AaQtlzLPlP4wKyJcB8Pi83IpfLoVqtYmFh0ZnQ0nU0qHn/uSJ+0G7fiPl8VAL0+/20cyZdsTLm57+hdXIqQAdKE+1T869nCnZfK+I5dsNYAgwGg7i8MhwIG8cbG0Wafo1+X6FPk5VfPUDxqSK+r6oCcEuAU1NT0GhhDQLZVtwsIZvNShFPuDX+FqtPFORfPhS/9X5M8m4JkO/pyakKo0uwof3e/SMF3FQg2PfHCgoEMWlS9nbshgqQt755eIwr3RTYOV+vRlMK1j5OIPlIwY93YxgM39mAIBxzns9HJcDt7W3EYjH5OD6fD5OTk7KbrDo99go12TBbDOV8Peuxh5Zl0Z8ATUdFOjWy55jztt1VArw/Af8A9+n0bhYJ0I4AAAAASUVORK5CYII="/>','at the right end of the address bar and click "<b>Always allow plug-ins</b>". Then refresh/restart the browser.</div>',"</div></div>"].join("");n.innerHTML=t;for(var o=0;o<Xn.links.length;o++)"DWT_CloseNonAllowedDiv"==Xn.links[o].className&&(Xn.links[o].onclick=i)}function i(){l.get(e._strDWTNonInstallInnerContainerID).style.display="none",l.get(e._strDWTInnerContainerID).style.display="inline"}},jn.__unload=jn.dispose=function(){var e,n=this;if(n._containerElement)e=n._containerElement;else{var r=n._containerID;r&&(e=l.get(r))}e&&(e.innerHTML=""),this._containerElement=null,delete c.DWT.ContainerMap[n._containerID],delete c.DWT.WebTwainIdMap[n._id]},jn._getErrorString=function(){return this._errorString},l.detect._controlDetect=function(){var e=l.detect.arySTwains,n=e[0],r=n&&n._objectWebTwain;if(r){var t,o=c.DWT,i=!1;if(Vn.bIE)t=!c.navInfo.bOSx64||c.navInfo.bWOW64?"DynamicPdfCore_"+o.ActiveXPdfVersion+".dll":"DynamicPdfCorex64_"+o.ActiveXPdfVersion+".dll",0==r.ErrorCode&&""!=r.GetAddOnVersion("pdf",t)&&(i=!0);else 0==r.ErrorCode&&(i=!0);if(i){clearInterval(l.detect._varSeed);var a=function(n,r,t){var o,i;for(o=0;o<e.length;o++)i=e[o],l.attachProperty(i),l.attachMethod(i),i._attachEvents(),l.detect.ssl&&(i.IfSSL=!0,i.HTTPPort=443),0==n?i.GetLicenseInfo(r).then((function(e){e&&i._setConvertMode(i._pdfConvertMode)})):(i._blts=!0,""!=r&&""!=t?(i.SetLTSInfo(r,t),i.GetLicenseInfo().then((function(e){return e&&i._setConvertMode(i._pdfConvertMode),c.DWT.lcheckLic(c.DWT.EnumInstance.dwt_desktop,e,"")}))):i.__licenseInfo={LTS:!0,Detail:[]},c.DWT.laddDWTObj(i)),l.attachAddon(i),i._objectWebTwain.BrokerProcessType=l.product._iBrokerProcessType,Vn.bWin||(i._objectWebTwain.ImageCaptureDriverType=l.product._iImageCaptureDriverType),l.isFunction(i.__OnAxReady)&&i.__OnAxReady()};if(l.License.isLTS()){var s=c.DWT.li({instanceMode:c.DWT.EnumInstance.dwt_desktop,axInstance:r},"");if(!c.DWT.lisValidID(s))return void a(1,"","");Un(c.DWT.EnumInstance.dwt_desktop,"").then((function(e){a(1,e.ar,e.cu)}),(function(e){e&&(c.DWT.lsetException(e.code||e.ltsErrorCode,e.message,!0),c.DWT.OnLicenseException()),a(1,"","")}))}else a(0,o.ProductKey,"")}else l.detect.bNoControlEvent||(l.noControl(n),l.detect.bNoControlEvent=!0),l.isFunction(n.__OnAxNotInstalled)&&n.__OnAxNotInstalled()}else clearInterval(l.detect._varSeed)},l.ie={},l.ie.DynamicWebTwain=function(e){var n=new zn(e);return n._createControl(),l.detect.arySTwains.push(n),n},l.ie.closeAll=function(){var e,n,r,t=l.detect.arySTwains;for(e=0;e<t.length;e++)(n=t[e])&&n._objectWebTwain&&(r=n._objectWebTwain)&&0==r.ErrorCode&&r.RemoveAllImages();l.detect.arySTwains=[]},l.closeAll=l.ie.closeAll,c.DWT.RemoveAllAuthorizations=function(){return!1},c.DWT.GetWebTwain=c.DWT.GetWebTwainEx=function(e){var n=e,r=c.DWT.WebTwainIdMap;if(!n){var t=Object.keys(r);return t.length>0?r[n=t[0]]:void 0}if(n in r)return r[n];var o=c.DWT.ContainerMap;return n in o?o[n]:void 0},l.domReady((function(){var e=document.createElement("style"),n=["dialog[open]{display:block}dialog[closed]{display:none}.dynamsoft-backdrop{position:fixed;background:rgba(128,128,128,0.1);top:0;bottom:0;left:0;right:0;z-index:-99999999;}.dynamsoft-dwt-dialogProgress{width:330px;background:#FFF}.dynamsoft-finalMessage{margin:0;color:#3a3a3a;font:20px Arial,sans-serif}.dynamsoft-desc{margin:7px 0;color:#3a3a3a;font:14px Arial,sans-serif}.dynamsoft-status{color:#555;font:14px/22px Arial,sans-serif;margin-bottom:5px}.dynamsoft-progressBar{-webkit-appearance:none;width:280px;margin-bottom:20px;height:14px}.dynamsoft-progressBar,.dynamsoft-progressBar::-webkit-progress-bar{background-color:#e7e7e7;border-radius:7px}.dynamsoft-progressBar::-webkit-progress-value,.dynamsoft-progressBar::-moz-progress-bar{background-color:#50a8e1;border-radius:7px}.dynamsoft-loadingMsg{width:290px;height:290px;margin:auto;color:#CCC;border-width:1px;background:#FFF}.dynamsoft-loadingMsg-msg{margin:0 0 15px 25px;color:#3a3a3a;font:20px Arial,sans-serif}.dynamsoft-loadingMsg-desc{text-align:center;margin:0 0 15px 0;color:#3a3a3a;font:14px Arial,sans-serif}.ds-dwt-loaderBar-noserver-parent{height:100%;}.ds-dwt-loaderBar-noserver{margin: 0 auto;padding-top: 50px;text-align: center;}.ds-dwt-loaderBar-noserver img{height: 100px}"].join("");e.type="text/css";try{e.appendChild(document.createTextNode(n))}catch(r){e.styleSheet.cssText=n}document.body.appendChild(e)}));var Jn,Yn=c.navInfoSync.bAndroid?"local.dynamsoft.com":"127.0.0.1",qn={loaderBarClassName:"ds-dwt-loaderBar",loaderBarBackgroundColor:"",loaderBarSource:c.navInfoSync.bIE?c.Lib.loaderBarSourceIE:c.Lib.loaderBarSource,errorMessages:{ERR_MODULE_NOT_INSTALLED:"Error: The Dynamic Web TWAIN module is not installed.",ERR_BROWSER_NOT_SUPPORT:"Error: This browser is currently not supported.",ERR_CreateID_MustNotInContainers:"Error: Duplicate ContainerId detected while creating a Dynamic Web TWAIN object.",ERR_CreateID_WebTwainIdDuplicated:"Error: Duplicate ID detected while creating a Dynamic Web TWAIN object.",ERR_CreateID_NotContainer:"Error: The ID of the target DIV for the new DWT object is invalid.",limitReachedForZoomIn:"Error: You have reached the limit for zooming in",limitReachedForZoomOut:"Error: You have reached the limit for zooming out",insufficientParas:"Error: Not enough parameters.",invalidAngle:"Error: The angle you entered is invalid.",invalidIndex:"Error: The index you entered is invalid.",invalidHeightOrWidth:"Error: The height or width you entered is invalid.",imageNotChanged:"Error: You have not changed the current image."},generalMessages:{checkingDWTVersion:"Checking WebTwain version ..."},customProgressText:{upload:"Uploading...",download:"Downloading...",load:"Loading...",decode:"Processing...",decodeTIFF:"Processing tiff...",decodePDF:"Processing pdf...",encode:"Processing...",encodeTIFF:"Processing tiff...",encodePDF:"Processing pdf...",transfer:"Transferring...",canvasLoading:"Loading ..."},buttons:{titles:{previous:"Previous Image",next:"Next Image",print:"Print Image",scan:"Scan Documents",load:"Load Local Images",rotateleft:"Rotate Left",rotate:"Rotate",rotateright:"Rotate Right",deskew:"Deskew",crop:"Crop Selected Area",cut:"Cut Selected Area",changeimagesize:"Change Image Size",flip:"Flip Image",mirror:"Mirror Image",zoomin:"Zoom In",originalsize:"Show Original Size",zoomout:"Zoom Out",stretch:"Stretch Mode",fit:"Fit Window",fitw:"Fit Horizontally",fith:"Fit Vertically",hand:"Hand Mode",rectselect:"Select Mode",zoom:"Click to Zoom In",restore:"Restore Original Image",save:"Save Changes",close:"Close the Editor",removeall:"Remove All Images",removeselected:"Remove All Selected Images"},bShowAllButtons:!0,visibility:{scan:!0,load:!0,print:!0,removeall:!0,removeselected:!0,rotateleft:!0,rotate:!0,rotateright:!0,deskew:!0,crop:!0,cut:!0,changeimagesize:!0,flip:!0,mirror:!0,zoomin:!0,originalsize:!0,zoomout:!0,stretch:!0,fit:!0,fitw:!0,fith:!0,hand:!0,rectselect:!0,zoom:!0,restore:!0,save:!0,close:!0}},dialogText:{dlgRotateAnyAngle:["Angle :","Interpolation:","Keep size","  OK  ","Cancel"],dlgChangeImageSize:["New Height :","New Width :","Interpolation:","  OK  ","Cancel"],saveChangedImage:["You have changed the image. Do you want to keep the change(s)?","  Yes  ","  No  "],selectSource:["Select Source:","Select","Cancel","There is no source available!"]}};function Zn(){var e=c.DWT.Host;return l.isString(e)&&""!=e||(c.DWT.Host=e=Yn),e}!function(e){e.NONE=0,e.TRACE=1,e.DEBUG=2,e.INFO=4,e.WARN=8,e.ERROR=16}(Jn||(Jn={}));var Qn=l.getLogger(),$n=function(){function n(){e(this,n)}return o(n,null,[{key:"LogLevel",get:function(){return this._logLevel},set:function(e){this._logLevel=e}},{key:"LogFunc",set:function(e){this._logFunc=e}},{key:"all",value:function(e,n){if((this._logLevel&e)==e)if(this._logFunc)this._logFunc(n,e);else switch(e){case Jn.DEBUG:Qn.debug(n);break;case Jn.ERROR:Qn.error(n);break;case Jn.INFO:Qn.info(n);break;case Jn.WARN:Qn.warn(n);break;case Jn.TRACE:Qn.trace(n)}}},{key:"trace",value:function(e){this.all(Jn.TRACE,e)}},{key:"debug",value:function(e){this.all(Jn.DEBUG,e)}},{key:"info",value:function(e){this.all(Jn.INFO,e)}},{key:"warn",value:function(e){this.all(Jn.WARN,e)}},{key:"error",value:function(e){this.all(Jn.ERROR,e)}}]),n}();function er(e){window.console&&(e instanceof Error||l.isString(e)?window.console.error(e):window.console.error(l.stringify(e)))}i($n,"_logLevel",Jn.ERROR),i($n,"_logFunc",undefined);var nr={GET_TASKID:0,GET_EVENT_TASKID:1,ONMESSAGE_PROCESS_DATA:2,ONMESSAGE_GET_TASKID:3,ONMESSAGE_GET_EVENT_TASKID:4,HANDLE_RAW_MESSAGE:5,HANDLE_PROCESSED_MESSAGE:6},rr=o((function Or(n,r,t,o,i){e(this,Or),this.server=n,this.port=r,this.ssl=t,this.useWS=o,this.protocol=i}));function tr(e,r,t){if(l.isString(e)&&(e.indexOf("Function not found")>0||e.indexOf("Version not found")>0))r&&r(e);else{var o=e.data;if("object"===n(o))return o=null,e=null,void(t&&t());var i=o.replace(/\0/g,"");try{r&&r(i)}catch(a){l.log(o),t&&t()}o=null,e=null}}function or(e,n){e&&e.readyState!=rn&&e.readyState!=tn?e.readyState==en?(e.onerror=function(n){n&&l.log("websocket error: "+n),e._reject&&(e._reject(),e._reject=null),e.close()},e.onclose=function(n){e.onclose=null,e.onerror=null,e.onmessage=null,e.onopen=null,e._reject=null},e.onopen=function(){e.readyState==nn?(e.onopen=null,e.send(n)):e.readyState==en&&(e.onopen?setTimeout(e.onopen,100):e._reject&&(e._reject(),e._reject=null))}):e.readyState==nn&&(e.onopen=null,e.send(n)):e._reject&&(e._reject(),e._reject=null)}function ir(e,n,r){var t=r;return t||(t=c.navInfoSync.bSSL?"https://":"http://"),[t,e,":",n,"/"].join("")}var ar=function(){function n(){e(this,n)}return o(n,null,[{key:"postStringDataByWS",value:function(e,n){return new l.Promise((function(r,t){e.onmessage=function(n){tr(n,(function(n){r(n),e.close(),e=null}),(function(){t(),e.close(),e=null}))},e._reject=t,or(e,n)}))}},{key:"postStringDataByWSUrl",value:function(e,r){var t=new l.Promise((function(t,o){var i=n.newWebsocket(e,!1);i.onmessage=function(e){tr(e,(function(e){t(e),i.close(),i=null}),(function(){o(),i.close(),i=null}))},i._reject=o,or(i,r)}));return c.navInfoSync.bEdge&&t["catch"]((function(){return new l.Promise((function(t,o){var i=n.newWebsocket(e,!0);i.onmessage=function(e){tr(e,(function(e){t(e),i.close(),i=null}),(function(){o(),i.close(),i=null}))},i._reject=o,or(i,r)}))})),t}},{key:"newWebsocket",value:function(e,n){var r,t=c.dcp.wsProtocol,o=window.MozWebSocket;if(void 0!==o)r=t?new o(e,t):new o(e);else{var i=window.WebSocket;if(n){var a=window,s=parent;try{for(;a!=s&&s.WebSocket;)i=s.WebSocket,a=s.window,s=s.parent}catch(u){i=window.WebSocket}}r=t?new i(e,t):new i(e)}return r}},{key:"getWsUrl",value:function(e,n,r){var t=r;return t===undefined&&(t=c.navInfoSync.bSSL),ir(e,n,t?"wss://":"ws://")}},{key:"getDDMUrl",value:function(e,n,r){var t,o,i="/";return l.startsWith(e,"https://")?t=!0:l.startsWith(e,"http://")?t=!1:e=(t=l.detect.ssl)?"https://"+e:"http://"+e,o=t?"18626/":"18625/",l.endsWith(e,"/")&&(i=""),n?[e,i,"ddm/",o,r].join(""):[e,i,r].join("")}},{key:"getModuleUrl",value:function(e){var n,r=c.dcp;return n=ir(Zn(),c.navInfoSync.bSSL?r.SSLPort:r.Port),e?n+e:n}}]),n}();c.DWT.NetManager=ar;var sr,ur=function(){function n(r){e(this,n);var t,o,i=this;if(i._id=r.id,i._clientId=l.getRandom(),i._uuidForActiveUI=null,i._bReady=s,i._destroy=s,i._bMustUpgradeService=s,i._wsClient=null,i._wsRetry=0,i._wsFailedTimes=0,i._strHttpContentTypeFieldValue="application/octet-stream",i._bConnecting=s,i._bNoMask=s,i._bNotShowMessage=s,i.__serverPlatform=xe.enumWindow,i.__productKey="",i.__licenseInfo=null,i._reconnectTimeSpan=c.Lib.product.RemoteReconnectTimeSpan,i._reconnectShortSpan=300,i._reconnectShortSpanTimes=5,i._bIfShowProgressBar=u,i.__IfShowCancelDialogWhenImageTransfer=u,r.dmService){var a,d,f,g,T,p,h=oe(r.dmService),m="/",_="";d=h.server;var I=new l.Uri(r.dmService.server),S=I.scheme;S&&(S=S.toLowerCase()),"https"==S?(a=!0,f=d.substring(8)):"http"==S?(a=!1,f=d.substring(7)):(f=d,d=(a=l.detect.ssl)?"https://"+d:"http://"+d),l.isLocalIP(I.hostname||I.scheme)?i._bRemoteMode=s:i._bRemoteMode=u,l.endsWith(d,"/")&&(m="");var v=h.attrs;if(v){var w,E;g=(null===(w=v)||void 0===w?void 0:w.UUID)||"";var b=(null===(E=v.modules)||void 0===E?void 0:E.length)||0;if(""!=g&&b>0){var y;a?b>1&&b>1+(y=v.modules[1])+2&&(T=v.modules[1+y+2]):b>2&&(T=v.modules[2]),l.endsWith(T,"/")&&(m=""),_=[g,"/",T,"/"].join("")}}else v={UUID:"",service_type:on};p=[d,m,_].join(""),v.url=p,i._serverInfo=new rr([f,m,_].join(""),null,a,!0,c.dcp.wsProtocol),i._httpUrl=p,i._dmService=h}else{var W,C=r.port,D=l.detect.ssl;W=r.host?r.host:Zn(),l.isLocalIP(W)?i._bRemoteMode=!1:i._bRemoteMode=!0,C||(C=D?c.dcp.SSLPort:c.dcp.Port),i._serverInfo=new rr(W,C,D,!0,c.dcp.wsProtocol),i._httpUrl=(t=i._serverInfo,(o=t.server)||(o=Zn()),t.ssl?["https://",o,":",t.port,"/"].join(""):["http://",o,":",t.port,"/"].join("")),i._dmService={server:i._httpUrl,attrs:{url:i._httpUrl,UUID:"",service_type:on},normal:!0}}}var r,t;return o(n,[{key:"_connnect",value:(t=V(Z.mark((function i(){var e;return Z.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e=this,n.abrupt("return",new l.Promise((function(n,r){var t,o;t=e._serverInfo.server,o=e._serverInfo.port,c.DWT.CheckConnectToTheService(t,o,n,r)})));case 2:case"end":return n.stop()}}),i,this)}))),function(){return t.apply(this,arguments)})},{key:"_waitForConnect",value:function(){var e=this;return e._wsRetry=0,e._bReady?l.Promise.resolve():new l.Promise((function(n,r){e._wsCheckResolve=n,e._wsCheckReject=r,dr(e)}))}},{key:"_resetErr",value:function(){this._errorCode=0,this._errorString="";var e=c.DWT.licenseException;e.code=0,e.message=""}},{key:"_isValid",value:function(){return!this._destroy||(l.Errors.Destroyed(this),!1)}},{key:"_getWSCallback",value:function(){return fr}},{key:"_getWSContextData",value:function(){return""}},{key:"_additionalWSCallback",value:function(e,n,r,t){"GetLicenseInfo"==e?n._lic_callback=function(e){return r(e,nr.HANDLE_PROCESSED_MESSAGE,"0",t)}:"ConvertToBlob"==e&&n._blob_callbacks.push((function(e){return r(e,nr.HANDLE_RAW_MESSAGE,"0",t)}))}},{key:"_innerSendByWS",value:function(e,n,r,t,o){var i,a,u,c,d=this,f=this._getWSCallback();r&&r.cmdId?(i=r.cmdId,u=lr(d._clientId,i),c=lr(d._clientId,"")):(i=0,u=0,c=0);var g=cr(d._clientId,e,n,i),T=d._wsClient;a={client:T,userData:{stwain:d,command:r},taskId:i,eventTaskId:u,lastEventTaskId:c};var p,h,m,_,I,S,v,w,E=0;if(!o){try{T.request(g,f,a)}catch(y){l.log(y)}return s}if(m=new ArrayBuffer(12),t)if(t instanceof Blob)E=t.size;else if(t instanceof ArrayBuffer||t instanceof Uint8Array)E=t.byteLength;else if(t instanceof Array)E=t.length;else{var b=t;E=b.size||b.byteLength||b.length}for(h=(p=(v=new Blob([g])).size)+E,_=new DataView(m),S=0;S<8&&h;S++)_.setUint8(S,h%256),h=Math.floor(h/256);for(S=0;S<4&&p;S++)_.setUint8(8+S,p%256),p=Math.floor(p/256);return I=new Blob([m,v]),w=T.request(I,f,a),this._additionalWSCallback(e,T,f,a),E>0&&(w=T.request(t,f,a)),m=null,v=null,I=null,_=null,t=null,w}},{key:"_sendDataConnectWithSocket",value:function(e,n,r,t){var o=this;return new l.Promise((function(r,i){o._sendData(e,n,!0,(function(e){var n=!1;try{n=l.isString(e)?l.parse(e):e}catch(i){}if(o._resetErr(),n){if(n instanceof Blob||In(n))return void r(n);Ee(n)&&(o._errorCode=n.exception,o._errorString=n.description)}r(t?n:n.result)}),(function(e){i({code:o._errorCode,message:o._errorString})}))}))}},{key:"_sendDataByHttpAsync",value:function(e,r,t,o,i){var a,s=this;if(s._resetErr(),!s._isValid())return l.Promise.reject({code:s._errorCode,message:s._errorString});if(n.isServerInvalid(s))return i?l.Promise.reject({code:s._errorCode,message:s._errorString}):s._waitForConnect().then((function(){return s._sendDataByHttpAsync(e,r,t)}));if(c.DWT.ConnectWithSocket)return s._sendDataConnectWithSocket(e,r,t,o);a={method:"post",async:!0,body:cr(s._clientId,e,r,0),dataType:null!=t?t:"text"};var u=null,d=l.guid();return s._bIfShowProgressBar&&(u=l.progressContext),U(u,d)([s._httpUrl,"fa/",e].join(""),a).then((function(e){var n=!1;try{n=l.isString(e)?l.parse(e):e}catch(r){}if(n){if(n instanceof Blob||In(n))return n;if(!Ee(n))return s._resetErr(),o?n:n.result;s._errorCode=n.exception,s._errorString=n.description}else c.Lib.Errors.InvalidResultFormat(s);throw{code:s._errorCode,message:s._errorString}}),(function(e){if(s._errorCode=e.code,s._errorString=e.message,!l.page.bUnload)throw e}))}},{key:"_sendData",value:function(e,r,t,o,i){var a=this,s=null,u=null,c=!1,d=!0;if(!a._destroy){if("ActiveUI"==e?d=!1:c=n.isServerInvalid(a),c)return a._waitForConnect().then((function(){a._sendData(e,r,t,o,i)}))["catch"]((function(e){l.isFunction(i)&&i(e.code,e.message)}));var f;l.isFunction(o)&&(u=o),l.isFunction(i)&&(s=i),f="GetLicenseInfo"==e||"ConvertToBlob"==e||"Heartbeat"==e?0:vn();var g=this._getWSContextData(),T={cmd:e,cmdId:f,sFun:u,fFun:s,contextData:g,rawData:null!=t&&t};return a._innerSendByWS(e,r,T,null,d)}}},{key:"_innerFunV2",value:(r=V(Z.mark((function a(e,n,r){var t,o;return Z.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(t=this,!r){i.next=7;break}return i.next=4,t._sendDataConnectWithSocket(e,n,"json",!0);case 4:o=i.sent,i.next=10;break;case 7:return i.next=9,t._sendDataByHttpAsync(e,n,"json",!0);case 9:o=i.sent;case 10:if(!(o&&c.Lib.isArray(o.result)&&o.result.length>0)){i.next=12;break}return i.abrupt("return",o.result[0]);case 12:return i.abrupt("return",o);case 13:case"end":return i.stop()}}),a,this)}))),function(e,n,t){return r.apply(this,arguments)})},{key:"__OnRecieveMsg",value:function(e,n){var r=this;if(e.event)return r._handleEvent(e,n.contextData);if(c.DWT.ConnectWithSocket){var t=e,o=null==n?void 0:n.cmd;return"ActiveUI"==o||"VersionInfo"==o||"ConvertToBase64"==o||"ConvertToBlob"==o?n.sFun&&l.isArray(e.result)&&e.result.length>0?(n.sFun(e.result),!0):(n.fFun&&n.fFun(e.result),!1):(t=n.rawData?e:l.isArray(e.result)&&e.result.length>0?e.result[0]:e.result,n.sFun?n.sFun(t):n.fFun&&n.fFun(t),e=null,!0)}return Ee(e)?(r._errorCode=e.exception,r._errorString=e.description):(r._errorCode=0,r._errorString=""),n.sFun&&l.isArray(e.result)&&e.result.length>0?(n.sFun(e.result),!0):(n.fFun(e.result),!0)}},{key:"dispose",value:function(){this._bReady=s,this._destroy=u}},{key:"isDestroy",get:function(){return this._destroy}},{key:"getServiceInfo",value:function(){return this._dmService}},{key:"_handleOnBitmapChangedEvent",value:function(e,n){var r="_OnBitmapChanged";if(l.isFunction(this[r]))try{this[r](e.result,e,n)}catch(t){er(t)}return s}},{key:"_handleEvent",value:function(e,n){var r=["_",e.event].join("");return l.isFunction(this[r])?(this[r](e.result,e),u):s}}],[{key:"isServerInvalid",value:function(e){var n,r;if(n=!e._bReady||null===e._wsClient,r=e._bMustUpgradeService,n){var t,o,i,a;if(e._bRemoteMode)t=null!==(o=null===(i=e.getServiceInfo())||void 0===i||null===(a=i.attrs)||void 0===a?void 0:a.name)&&void 0!==o?o:"";l.Errors.DynamsoftServiceStopped(e,t)}else r?l.Errors.MustUpgradeService(e):e.isDestroy&&l.Errors.Destroyed(e);return n||r||-2208==e._errorCode||e.isDestroy}}]),n}();function cr(e,n,r,t){var o=[];o.push("{"),o.push('"id":"'),o.push(e),o.push('"'),t&&(o.push(',"cmdId":"'),o.push(t),o.push('"')),o.push(',"method":"'),o.push(n),o.push('"'),o.push(',"module":"dwt","version":"');var i=[l.product.getDWTPrefix(),l.product.getServerVersionInfo()].join("");return o.push(i),o.push('"'),r!==undefined&&null!==r&&(o.push(',"parameter":'),o.push(r)),o.push("}"),o.join("")}function lr(e,n){return["evt",e,n].join("_")}function dr(e){if(e._bReady)e._wsCheckResolve();else{if(c.DWT.bConnectCanceled)return l.asyncQueue.stop(),l.Errors.UserCanceled(e),void e._wsCheckReject({code:e._errorCode,message:e._errorString});if(e._wsRetry>10)return l.Errors.ThrowString_FailedToCreateDWTObject(e),void e._wsCheckReject({code:e._errorCode,message:e._errorString});e._wsRetry++,setTimeout((function(){dr(e)}),1100)}}function fr(e,n,r,t){return gr.apply(this,arguments)}function gr(){return(gr=V(Z.mark((function e(r,t,o,i){var a,s,u,d,f,g,T;return Z.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!=nr.GET_TASKID){e.next=4;break}return e.abrupt("return",i.taskId);case 4:if(t!=nr.GET_EVENT_TASKID){e.next=8;break}return e.abrupt("return",i.eventTaskId);case 8:if(t!=nr.ONMESSAGE_PROCESS_DATA){e.next=17;break}if("object"!==n(r)){e.next=11;break}return e.abrupt("return",r);case 11:if(!((d=r).indexOf("Version not found")>=0||d.indexOf("Function not found")>=0)){e.next=14;break}return e.abrupt("return",{cmdId:null!=o?o:0});case 14:return e.abrupt("return",l.parse(r));case 17:if(t!=nr.ONMESSAGE_GET_TASKID){e.next=25;break}if(!r){e.next=22;break}if(!r.event){e.next=21;break}return e.abrupt("return",0);case 21:return e.abrupt("return",r.cmdId);case 22:return e.abrupt("return",r);case 25:if(t!=nr.ONMESSAGE_GET_EVENT_TASKID){e.next=31;break}if(!r||!r.event){e.next=28;break}return e.abrupt("return",lr(r.id,r.cmdId));case 28:return e.abrupt("return",0);case 31:if(t!=nr.HANDLE_RAW_MESSAGE){e.next=59;break}if(a=null==i?void 0:i.userData){e.next=35;break}return e.abrupt("return",!1);case 35:if(s=a.stwain,u=a.command){e.next=39;break}return e.abrupt("return",!1);case 39:if(s&&l.isFunction(s.__OnWSMessage)&&s.__OnWSMessage(r),"object"!==n(r)){e.next=44;break}if(!c.DWT.ConnectWithSocket){e.next=44;break}return"ConvertToBlob"!=u.cmd&&"GetImageByIndex"!=u.cmd||u.sFun(r),e.abrupt("return",!0);case 44:if(!((f=r.replace(/\0/g,"")).indexOf('"method" : "Heartbeat"')>=0)){e.next=47;break}return e.abrupt("return",!0);case 47:if(!(f.indexOf('"method" : "EnableBuffer"')>=0||f.indexOf('"method" : "GetBuffer"')>=0)){e.next=50;break}return c.DWT.lwsproc(f,u),e.abrupt("return",!0);case 50:if(!(f.indexOf("Exception:")>=0||0==f.indexOf("Error"))){e.next=57;break}return g=r,T=!1,l.log(g+"@"+u.cmd),u.fFun&&(T=u.fFun(g)),!T&&s&&l.isFunction(s.__OnPrintMsg)&&s.__OnPrintMsg(g),e.abrupt("return",!0);case 57:e.next=70;break;case 59:if(t!=nr.HANDLE_PROCESSED_MESSAGE){e.next=70;break}if(a=null==i?void 0:i.userData){e.next=63;break}return e.abrupt("return",!1);case 63:if(s=a.stwain){e.next=66;break}return e.abrupt("return",!1);case 66:if(u=a.command){e.next=69;break}return e.abrupt("return",!1);case 69:return e.abrupt("return",s.__OnRecieveMsg(r,u));case 70:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(e){e.IT_BMP=0,e.IT_JPG=1,e.IT_TIF=2,e.IT_PNG=3,e.IT_PDF=4,e.IT_ALL=5,e.IT_MULTIPAGE_PDF=7,e.IT_MULTIPAGE_TIF=8,e.IT_J2K=14}(sr||(sr={})),c.DWT.EnumDWT_ImageType=sr;var Tr={notSupportProperty:function(e){},notSupportMethod:function(e){},cformat:function(e,n){if(l.isString(e)){var r,t,o,i,a,s=e.indexOf("<%");if(-1==s)return e;if(t=e.substring(0,s),!(s+2<(r=e.indexOf(">",t))))return e;o=e.substring(s+1,r),i=e.substring(r+1);try{a=l.sprintf(o,n)}catch(u){a=""}return[t,a,i].join("")}return""},refreshImageAfterInvokeFun:function(e,n,r){return 1==r},loadHttpBlob:function(e,n,r,t,o,i,a,d){var f,g,T=s;if(g={method:n,dataType:"blob"},d&&(g.headers=d),""!=e.HTTPUserName&&(g.username=e.HTTPUserName,g.password=e.HTTPPassword),e.__HTTPPostResponseString="",t){if((c.Lib.env.bMobile||c.navInfoSync.bChrome||c.navInfoSync.bFirefox)&&"get"==n){var p=l.guid();return l.progressContext&&(l.progressContext._onPercent=a),U(l.progressContext,p)(r,g).then((function(n){var r=n.type;if("text/plain"==r||"text/html"==r||"text/json"==r){var t=new FileReader;t.readAsText(n),t.onload=function(){e.__HTTPPostResponseString=t.result,o(n)},t.onerror=function(){o(n)}}else o(n)}),(function(n){n&&n.code?(e._errorCode=n.code,e._errorString=n.message):n&&n.httpCode?l.Errors.HttpDownloadError(e,!1,n.message,n.httpCode):l.Errors.HttpDownloadUrlError(e),l.isFunction(i)&&i({code:e._errorCode,message:e._errorString})})),!0}g.onSuccess=function(n,r,t){if((t?t.getResponseHeader("content-type"):"").indexOf("text/")>=0){var i=new FileReader;i.readAsText(n),i.onload=function(){e.__HTTPPostResponseString=i.result,o(n)},i.onerror=function(){o(n)}}else o(n)},l.isFunction(a)&&(g.beforeSend=function(e){e.addEventListener("progress",(function(e){!c.navInfoSync.bSafari&&e&&(delete e.totalSize,delete e.position),a(e)}),s)}),T=u}else c.navInfoSync.bIE?(g.dataType="arraybuffer",g.onSuccess=function(n,r,t){var i,a;(i=n||t.responseData)&&(a=new Uint8Array(i)),e.__HTTPPostResponseString=t.responseText,e._errorCode=0,e._errorString="",o(a),a=null,T=u}):(g.dataType="text",g.contentType="text/plain; charset=x-user-defined",g.mimeType="text/plain; charset=x-user-defined",g.onSuccess=function(n,r,t){var i,a,s;i=t.responseText,e.__HTTPPostResponseString=i,a=i.length,s=new Uint8Array(a);for(var c=0;c<a;c++)s[c]=i.charCodeAt(c);e._errorCode=0,e._errorString="",o(s),s=null,T=u}),g.headers?l.mix(g.headers,{"X-Requested-With":s}):g.headers={"X-Requested-With":s};if("post"==n){var h,m=e.httpFormFields;if(m)try{h=new FormData,l.each(m,(function(e,n){if(e instanceof Blob){var r=e.name;h.append(n,e,r)}else h.append(n,e)})),l.mix(g,{data:h,processData:s,contentType:s})}catch(I){}}f=function(n,r,t){var o,a;if(n&&l.isArray(n)&&n.length>2?(o=n[1],a=n[2]):(o=r,a=t),2!=a.state&&3!=a.state||0!=a.status)l.Errors.HttpDownloadError(e,s,o,a.status);else if("abort"===a.statusText){var c=u;l.Errors.HttpDownloadError(e,c)}else l.Errors.HttpDownloadUrlError(e);l.isFunction(i)&&i()},g.url=r,g.async=t,g.onError=f,g.onComplete=function(){e._cancelableObj=null};var _=x(g);return t&&l.progressContext&&(l.progressContext._onPercent=a,e.IfShowCancelDialogWhenImageTransfer&&l.progressContext.on("cancel",(function(){_.abort()}))),T},combineUrl:function(e,n,r){var t=[],o=n;return o===undefined||r===undefined?undefined:(l.isString(o)||(o=String(n)),0==o.indexOf("http://")?(o=o.replace("http://",""),t.push("http://")):0==o.indexOf("https://")?(o=o.replace("https://",""),t.push("https://")):(0==o.indexOf("//")&&(o=o.replace("//","")),e.IfSSL?t.push("https://"):t.push("http://")),t.push(o),o.indexOf(":")<0&&(e.HTTPPort||(e.HTTPPort=l.detect.ssl?443:80),(!l.detect.ssl&&80!=e.HTTPPort||l.detect.ssl&&443!=e.HTTPPort)&&(t.push(":"),t.push(e.HTTPPort))),0!==r.indexOf("/")&&t.push("/"),t.push(r),t.join(""))},httpPutImage:function(e,n,r,t,o,i,a){var d=u,f={method:"PUT",url:n,hasContent:u,processData:s,async:t,data:r,onSuccess:o,onError:function(){d=s,l.isFunction(i)&&i()},onComplete:function(){e._cancelableObj=null},beforeSend:function(e){l.isFunction(a)&&e.upload.addEventListener("progress",(function(e){!c.navInfoSync.bSafari&&e&&(delete e.totalSize,delete e.position),a(e)}),s)}};""!=e.HTTPUserName&&(f.username=e.HTTPUserName,f.password=e.HTTPPassword),t||l.mix(f,{headers:{"X-Requested-With":s}});var g=x(f);return l.progressContext&&(l.progressContext._onPercent=a,l.progressContext._onCancel=function(){g.abort()}),d},EVENTS:["OnPostAllTransfers","OnPostTransfer","OnPostLoad","OnPreTransfer","OnPreAllTransfers","OnResult","OnTransferCancelled","OnTransferError","OnSourceUIClose","OnGetFilePath","OnPercentDone","OnPostTransferAsync","OnPreAllTransfersAsync","OnRemoteScanStatusAsync","OnConsumed"],SEND_BACK_EVENTS:["OnPreAllTransfers","OnPreTransfer","OnPostTransfer","OnGetFilePath","OnPostLoad"],GetImageInfo:function(e,n){var r=e._ImgManager.convertClientIndexToServerId(n);return-1==r?(l.Errors.IndexOutOfRange(e),!1):e._innerFun("GetImageInfo",_n(r))},getBlobTypeByImageType:function(e){var n="application/octet-stream";switch(e){case sr.IT_BMP:n="image/bmp";break;case sr.IT_JPG:n="image/jpeg";break;case sr.IT_TIF:n="image/tiff";break;case sr.IT_PNG:n="image/png";break;case sr.IT_PDF:n="application/pdf";break;case sr.IT_J2K:n="image/jp2"}return n},callbacks:[],pushCallback:function(e,n,r){var t={method:e,callback:n,ticks:r};Tr.callbacks.push(t)},refreshUIRef:0,isServerInvalid:function(e){ur.isServerInvalid(e)},replaceLocalFilename:function(e){var n;return e===undefined?"":(n=(e=String(e)).replace(/\\/g,"\\\\"),c.navInfoSync.bFileSystem&&(n=decodeURI(n)),n)},getImageType:$,makeParams:_n,showMask:function(e,n,r){if(l.log("showMask:"+e+"--"+pr),0==pr)if(n){be(n);var t=l.mask.dlgMask;if(t){t.style.zIndex="10000";var o=l.one(".dynamsoft-backdrop",t.parentNode);o&&o.length>0&&(o[0].style.zIndex="10000")}}else be(r||{});pr++},hideMask:hr};l.html5.Funs=Tr;var pr=0;function hr(e){l.log("hideMask:"+e+"--"+pr),pr>1?pr--:pr<=1&&(l.detect.bMaskShow=!1,c.DWT.ScanDirectly||l.isFunction(c.DWT.OnWebTwainPostExecute)&&c.DWT.OnWebTwainPostExecute(),pr=0)}l._zdgb_xkz_dhk=function(){var e=l.install._dlgInstall;if(e){var n=l.one(".dynamsoft-dialog-closeTimer",e);if(n.getEL()){var r=parseInt(n.getEL().style.width);(r-=1)<=0?c.DWT.CloseDialog():(n.getEL().style.width=r+"%",setTimeout(l._zdgb_xkz_dhk,100))}}},l.ShowLicenseDialog=c.DWT.ShowMessage,l.createLoadingBarContent=function(){},l.openLoadingMsg=function(){l.product.bHTML5Edition&&function(){var e=qn,n=c.DWT&&c.DWT.CustomizableDisplayInfo;n&&l.isString(n.loaderBarSource)&&""!=n.loaderBarSource?l.loaderBarSource=n.loaderBarSource:c.navInfoSync.bIE?l.loaderBarSourceIE=e.loaderBarSource:l.loaderBarSource=e.loaderBarSource;n&&l.isString(n.loaderBarClassName)&&""!=n.loaderBarClassName?l.loaderBarClassName=n.loaderBarClassName:l.loaderBarClassName=e.loaderBarClassName;n&&l.isString(n.loaderBarBackgroundColor)?l.loaderBarBackgroundColor=n.loaderBarBackgroundColor:l.loaderBarBackgroundColor=e.loaderBarBackgroundColor}()},l.closeLoadingMsg=function(e){l.product.bHTML5Edition&&hr("closeLoadingMsg:"+e)};var mr=!1;function _r(e,n){return Ir.apply(this,arguments)}function Ir(){return(Ir=V(Z.mark((function e(n,r){var t,o;return Z.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&(i=c.MSG.Init_CheckProductKeyFormat,l.log(i)),l.License.isLicenseMixed(null,!0)||l.License.reparseProductKey(r),0==(t=c.DWT.licenseException).code){e.next=6;break}throw n&&Ce(t),{code:t.code,message:t.message};case 6:if(mr){e.next=11;break}if(o=!1,c.navInfoSync.bIE&&(o=c.navInfoSync.strBrowserVersion<=7),o||!l.License.isLTS()){e.next=11;break}return e.abrupt("return",new l.Promise((function(e,n){var r=c.DWT.ResourcesPath,t="";c.navInfoSync.bFileSystem||(t=l.timestamp),l.addScript([r,"/src/dynamsoft.lts.js",t].join(""),!0,!1,(function(){mr=!0,e()}))})));case 11:case"end":return e.stop()}var i}),e)})))).apply(this,arguments)}var Sr,vr=window;vr.console=vr.console||((Sr={}).log=Sr.warn=Sr.debug=Sr.info=Sr.error=Sr.time=Sr.dir=Sr.profile=Sr.clear=Sr.exception=Sr.trace=Sr.assert=function(){},Sr),vr.addEventListener("beforeunload",(function(){c.Lib.page.bUnload=!0,c.DWT.Unload(),c.Lib.page.OnUnload&&c.Lib.page.OnUnload()}));var wr,Er,br=function(e){var n=e.VersionInfo;if(!l.detect.bNeedUpgradeEvent&&!function(e){if(l.isUndefined(e))return!1;var n,r,t=Q(e.toString().toLowerCase());n=l.product.bActiveXEdition?c.DWT.ActiveXVersion:l.product.getServerVersionInfo(!0),r=(n=l.replaceAll(String(n),"[.]",",")).split(",");for(var o=t.length>r.length?t.length:r.length,i=0;i<o;i++){if(null==t[i]&&(t[i]=0),null==r[i]&&(r[i]=0),parseInt(t[i])<parseInt(r[i]))return!1;if(parseInt(t[i])>parseInt(r[i]))return!0}return!0}(n)){if(l.detect.bNeedUpgradeEvent=u,l.isFunction(c.DWT.OnWebTwainNeedUpgrade)&&c.DWT.OnWebTwainNeedUpgrade())return;var r=e._containerElement;r&&(l.one(r).before(l.install._strNonInstallDIV),l.show(l.install._divDWTNonInstallContainerID),l.hide(r)),""!=l.install._divDWTemessageContainer&&l.hide(l.install._divDWTemessageContainer),function(e,n){var r=c.navInfoSync;if(l.isFunction(c.OnWebTwainNeedUpgradeCallback)){var t,o,i={};if(r.bWin){if(r.bIE)o=c.dcp.getDSPath();else{var a=l.product;o=a.bHTML5Edition?c.dcp.getDSPath():a.getMSIPath()}t=xe.enumWindow}i["default"]=o;var s=l.one(".dynamsoft-dialog-license");s&&s.getEL()&&(s.getEL().style.display="none"),l.detect.needUpgrade=u,c.OnWebTwainNeedUpgradeCallback(l.product.name,i,l.product.bHTML5Edition,t,r.bIE,r.bSafari,l.detect.ssl,l.env.strIEVersion,l.detect.bPromptJSOrServerOutdated,e,n)}}()}};function yr(){var e,n,r,t,o,i=c.DWT.Containers,a=l.Promise.resolve(0),s=c.DWT.licenseException;if(i&&i.length>0){for(0==s.code?vr.DCP_DWT_OnClickCloseInstall&&vr.DCP_DWT_OnClickCloseInstall(!1,!0):l.error(s.message),n=0;n<i.length;n++)if(l.product.bActiveXEdition){if(i[n].Container?t=i[n].Container:i[n].ContainerId&&(t=l.get(i[n].ContainerId)),!Kn(t)||!t.id)continue;if(o=c.DWT.ContainerMap[t.id])break;if(r=i[n].WebTwainId,o=c.DWT.WebTwainIdMap[r])break}o&&br(o)}var u=!1;for(l.License.isLTS()&&l.isNumber(s.code)&&0!==s.code&&!0===s.fromLTS&&(u=!0),n=0;n<i.length;n++)r=i[n].ContainerId,(e=c.DWT.ContainerMap[r])||(r=i[n].WebTwainId,e=c.DWT.WebTwainIdMap[r]),e&&(u?l.product.bActiveXEdition&&l.hide(e._containerElement):l.product.bActiveXEdition&&(e.IfAllowLocalCache=!0,e.IfShowFileDialog=!0,e.IfDisableSourceAfterAcquire=!0,e.BrokerProcessType=l.product._iBrokerProcessType,0==n&&e.__licenseInfo&&(l.License.checkProductKey(e,{Core:!0})||c.navInfoSync.bWin&&l.License.checkProductKey(e,{Webcam:!0},!0)||l.License.checkProductKey(e,{Core:!0},!1)||De(e)))),e=null;i=null,u?(c.DWT.WebTwainIdMap={},c.DWT.ContainerMap={},l.detect.arySTwains.splice(0)):a=a.then((function(){setTimeout((function(){try{l.isFunction(c.DWT.OnWebTwainReady)?c.DWT.OnWebTwainReady():l.isFunction(vr.Dynamsoft_OnReady)&&vr.Dynamsoft_OnReady()}catch(e){er(e)}}),100)}),(function(e){!function(e){var n=c.DWT.licenseException;n.code=e.code,n.message=e.message,l.isFunction(c.DWT.OnWebTwainError)?c.DWT.OnWebTwainError(e):l.isFunction(window.Dynamsoft_OnError)&&window.Dynamsoft_OnError(e),e&&(e instanceof Error?l.error(e):l.error(l.stringify(e)))}(e)}))}function Wr(e,n,r){var t,o,i,a,d,f={id:e.WebTwainId,width:e.Width,height:e.Height};if(e.ContainerId?(f.container=l.get(e.ContainerId),f.containerId=e.ContainerId):e.Container&&(f.container=e.Container,f.containerId=e.Container.id),(""==(t=f.id)||!l.isString(t)&&!l.isNumber(t)?s:u)||(f.id=["dwt_",l.getRandom()].join("")),function(e){var n=e||{};n.basePath&&(l.env.basePath=n.basePath),n.pathType&&(l.env.pathType=n.pathType),l.isUndefined(n.bDiscardBlankImage)||(l.config.bDiscardBlankImage=n.bDiscardBlankImage),n.msgPrefix&&(l.config.msgPrefix=n.msgPrefix),n.msgSuffix&&(l.config.msgSuffix=n.msgSuffix),n.detectType&&(l.detect.detectType=n.detectType),n.tryTimes&&(l.detect.tryTimes=n.tryTimes);var r=c.DWT.RemoteScanConfig;r||(r={sessionTimeout:300,keepAwake:!0},c.DWT.RemoteScanConfig=r),r.keepAwake===undefined&&(r.keepAwake=!0)}(f),f.onAxReady=function(){if(c.DWT.ContainerMap[f.containerId]=o.getInstance(),c.DWT.WebTwainIdMap[f.id]=o.getInstance(),l.isFunction(n)){var e={stwain:o.getInstance(),bError:!1};n(e)}},f.onAxNotInstalled=function(){var e={};l.Errors.ServiceNotInstalled(e),l.isFunction(r)&&r({code:e._errorCode,message:e._errorString})},o=new l.ie.DynamicWebTwain(f),a=0,d=c.DWT.Containers)for(i=d.length-1;i>=0;i--){var g=d[i];g.Container?Kn(g.Container)&&a++:g.ContainerId&&Kn(l.get(g.ContainerId))&&a++}return l.detect.arySTwains.length==a&&(l.detect._varSeed=setInterval(l.detect._controlDetect,200)),o}function Cr(){if(!l.detect.axAutoLoadDone){var e,n=c.DWT.Containers;if(n)for(e=0;e<n.length;e++){var r=void 0;if(Kn(l.get(n[e].ContainerId))&&(r=n[e].ContainerId),r)if(!c.DWT.ContainerMap[r])return void setTimeout(Cr,200)}n=null,yr(),l.detect.axAutoLoadDone=!0,wr()}}c.DWT._innerLoad=V(Z.mark((function Fr(){var e,n,r;return Z.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l.page.bUnload=s,t.next=3,_r(!0,!1);case 3:if((e=c.DWT.Containers)&&0!==e.length){t.next=7;break}return l.log("Dynamsoft.DWT.Containers was not set."),t.abrupt("return",s);case 7:for(n=0;n<e.length;n++)r=e[n],!l.isString(r.WebTwainId)||l.isString(r.ContainerId)&&""!=r.ContainerId||(r.ContainerId=r.WebTwainId),i=void 0,a=void 0,(o=r).ContainerId?i=o.ContainerId:o.Container&&(i=o.Container.id),(Kn(l.get(i))?((a=c.DWT.ContainerMap[i])||l.isString(o.WebTwainId)&&(a=c.DWT.WebTwainIdMap[o.WebTwainId]),a?s:u):s)&&Wr(r,(function(){}),(function(e){Er(e),l.detect.axAutoLoadDone=!0}));return t.abrupt("return",l.detect.axAutoLoadDone?l.Promise.resolve():new l.Promise((function(e,n){wr=e,Er=n,setTimeout(Cr,200)})));case 9:case"end":return t.stop()}var o,i,a}),Fr)}))),l.ajax=x,l.fetch=H}();
